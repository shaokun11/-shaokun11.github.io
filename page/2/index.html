<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同进步">
<meta name="keywords" content="eos,eth,tron,区块链">
<meta property="og:type" content="website">
<meta property="og:title" content="hello shaokun">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="hello shaokun">
<meta property="og:description" content="记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同进步">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hello shaokun">
<meta name="twitter:description" content="记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同进步">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>hello shaokun</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hello shaokun</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">hello friend, let us go to the world together</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/14/基于eos连接scatter开发dapp(下)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/14/基于eos连接scatter开发dapp(下)/" itemprop="url">学习eos dapp开发，看这篇就够了（下）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-14T09:24:19+08:00">
                2018-10-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="eos智能合约开发-c-合约编写"><a href="#eos智能合约开发-c-合约编写" class="headerlink" title="eos智能合约开发 c++合约编写"></a>eos智能合约开发 c++合约编写</h4><blockquote>
<p>这里需要说明的一下，这个例子和官网提供的hello没有多大的区别,仅仅是带你多了解一下如何编写。其中遇到有些概念难以理解，建议还是参考官网的hello 从头看起</p>
</blockquote>
<pre><code>#include &lt;eosiolib/eosio.hpp&gt;  
#include &lt;eosiolib/print.hpp&gt;
#include&lt;string&gt;

using namespace eosio;
using std::string;

class todolist : public contract {  //继承 contract

  public:
  using contract::contract;           

  todolist(account_name self):contract(self){}   //构造函数
    // account_name 是eoslib中定义的一种类型

  [[eosio::action]]   // 以前的版本使用的 ///abi action ，eoscdt使用这种方式标识，更加的优雅，也就是你要对外开放的方法都加上才会生成在abi中
  void create(account_name author, const uint32_t id, const std::string &amp;description)
  {
  // 记住，这些action方法的返回值只能是void，不然会报错，只有实际做过的人才会知道 ，那你要问我如何读取区块链的内容呢？ 这个问题也困扰了我蛮久，继续看下面
    todo_index todos(_self, _self);
    // 实例化多索引列表，第一个参数是这张表是谁的 code ,即谁有权限去读写它
    // 第二个参数scope，相当于缩小范围去找到这张表
    // _self 是构造函数中的self
    // todo_index 是Multi_index的一个具体的类型，在下面定义的

    todos.emplace(author, [&amp;](auto &amp;new_todo) {
        new_todo.id = id;
        new_todo.description = description;
        new_todo.completed = 0;
    });
    // 使用todos这个表的实例，去添加一条todo
    // 第一个参数表示为这条内容的写入付费的account，第二个参数是一个lambda方法，拿到的参数是这个表中的一行的实例，然后赋值对应的数据即可

    print(&quot;todo#&quot;, id, &quot; created&quot;);
    // 这里，如果你使用命令行方式 执行，执行成功后会打印这个方法，但是如果是dapp开发，这是看不到的，又有一个疑问，那我们怎么知道执行成功了呢？
  }

  [[eosio::action]]
  void complete(account_name author,const uint32_t id)
  {  
  // 更改todo的状态为完成
  todo_index todos(_self, _self);

      auto todo_look = todos.find(id);
      // 是否用find()方法，去查找这条方法对应的实例
      eosio_assert(todo_look != todos.end(), &quot;todo does not exit&quot;);
    // 这里 如果找不到，todos.end() 会返回 null
      todos.modify(todo_look,author,[&amp;](auto &amp;t) {
          t.completed = 1;
      });

      print(&quot;todo #&quot; ,id ,&quot;marked as complted&quot;);
  }

  [[eosio::action]]
  void destroy(account_name author, const uint32_t id)
  {    
        require_auth(author);
        // 权限验证，只能够删除自己的todo

        todo_index todos(_self, author);
      auto todo_look = todos.find(id);
      todos.erase(todo_look);
      print(&quot;todo#&quot;, id, &quot; destroyed&quot;);
  }
  private:
    // 在eoscdt中 注意加上[[eosio::table]] ，否则abi中不会生成这个table
  struct [[eosio::table]] todo {
      uint64_t id;
      string description;
      uint64_t completed;

      uint64_t primary_key() const {
      // 这个方法是必须存在的，上面方法能够查找就是因为这个方法的存在，  
      // 所以说查找只用传入 id即可，  
      // 如果要使用其他的查找方式，得多定义几个查找的方法，最多可以定义16个  
      // 如何定义看官网，这里不演示了  
          return id;
      }

      EOSLIB_SERIALIZE(todo,(id)(description)(completed));
  };

  typedef eosio::multi_index&lt;N(todo),todo&gt; todo_index;
  // 这里定义了多索引列表的具体实现，N(todo)是将你的account 转换为 uint64_t 类型，第二个参数传入表名字， 定义的具体的类型是todo_index

};

EOSIO_ABI(todolist, (create)(complete)(destroy))
</code></pre><h4 id="eos智能合约开发-编译智能合约"><a href="#eos智能合约开发-编译智能合约" class="headerlink" title="eos智能合约开发  编译智能合约"></a>eos智能合约开发  编译智能合约</h4><blockquote>
<p>经过以上的步骤，我们编写好了智能合约，这个合约是一个todolist，可以增加todo,可以将todo变为完成的状态，还可以删除todo,只能删除自己的todo</p>
</blockquote>
<p>这里编译智能合约，需要下载好eoscdt,如果没有下载好，建议完整安装好eoscdt再继续往下走了  </p>
<ol>
<li><img src="/images/contract1.png" alt="contract"><br>新建一个todolist文件夹，将上面写好的todolist.cpp放进去    </li>
<li><p><img src="/images/contract2.png" alt="contract"><br>打开终端，进入文件夹，输入   </p>
<pre><code>eosio-cpp -o todolist.wasm todolist.cpp --abigen
</code></pre></li>
</ol>
<ol start="3">
<li><img src="/images/contract3.png" alt="contract"><br>成功后会在当前文件夹目录下生成 todolist.wasm 和 todolist.abi</li>
</ol>
<h4 id="eos智能合约开发-部署智能合约"><a href="#eos智能合约开发-部署智能合约" class="headerlink" title="eos智能合约开发 部署智能合约"></a>eos智能合约开发 部署智能合约</h4><blockquote>
<p>这里部署智能合约我暂时只找到使用 命令行的方式部署，如果哪位同学知道其他的方式部署，请告诉我，谢谢</p>
</blockquote>
<blockquote>
<p>合约的部署又得创建钱包导入账户，和我们在scatter的方式一样，只不过这次是在命令行上操作了，那接下来继续走</p>
</blockquote>
<ul>
<li><p><img src="/images/contract4.png" alt="contract">   </p>
<pre><code>//显示当前的钱包，如果是按照教程来，应该如图显示
cleos wallet list 
</code></pre></li>
<li><p><img src="/images/contract5.png" alt="contract">  </p>
<pre><code>// 创建钱包，记住将返回的钱包密匙保存起来
cleos wallet create —-to-console 
// 显示钱包
cleos wallet list 
</code></pre></li>
<li><p><img src="/images/contract6.png" alt="contract">  </p>
<pre><code>// 导入我们之前的导入scatter的密匙对的私钥
// 执行后粘贴 私钥就好
cleos wallet import
</code></pre></li>
<li><p><img src="/images/contract6.png" alt="contract">  </p>
<pre><code>// 导入我们之前的导入scatter的密匙对的私钥
// 执行后粘贴 私钥就好
cleos wallet import
</code></pre></li>
<li><p><img src="/images/contract7.png" alt="contract">  </p>
<pre><code>// 部署合约 eee,注意看提示内容，RAM不够了，怎么办？去买
// 参数解释
// -u 指定部署合约的网络
// set contract  部署合约的命令
// shaokun11113  部署到哪个账户上，注意 这里这个账户的私钥必须被导入钱包且已在 -u指定网络上进行注册
// /Users/shaokun/Documents/todolist  abi 和 wasm的 绝对路径 ，建议不要使用相对路径
//-p 指定权限
cleos -u http://jungle.cryptolions.io:18888 set contract shaokun11113 /Users/shaokun/Documents/todolist -p shaokun11113@active
</code></pre></li>
<li><p><img src="/images/contract8.png" alt="contract">  </p>
<pre><code>// 购买RAM
// -u 去哪里买
// system buyram  购买ram的命令
// shaokun11113  谁去买，谁付钱
// shaokun11113  谁受益 买来的ram 给谁
// -k 买多少 kbytes 
cleos -u http://jungle.cryptolions.io:18888 system buyram shaokun11113 shaokun11113 -k 1024
</code></pre></li>
<li><p><img src="/images/contract9.png" alt="contract"><br>  有时候你也许会遇到这种情况 ，那就需要之前创建钱包时的密匙进行解锁钱包</p>
</li>
<li><p><img src="/images/contract10.png" alt="contract">  </p>
<pre><code>// 解锁默认钱包，输入钱包秘钥就好， 可以使用-n 指定解锁的钱包名字
cleos unlock wallet
</code></pre></li>
<li><p><img src="/images/contract11.png" alt="contract">  </p>
<pre><code>// 再次部署合约，可以看到结果eosio::setcode eosio::sebabi说明部署成功
cleos -u http://jungle.cryptolions.io:18888 set contract shaokun11113 /Users/shaokun/Documents/todolist -p shaokun11113@active
</code></pre></li>
</ul>
<h4 id="eos智能合约开发-使用scatter-js进行交互"><a href="#eos智能合约开发-使用scatter-js进行交互" class="headerlink" title="eos智能合约开发 使用scatter.js进行交互"></a>eos智能合约开发 使用scatter.js进行交互</h4><blockquote>
<p>这里使用 create-react-app 脚手架创建项目，删除无用的文件，启动项目。这里有疑问的请百度</p>
</blockquote>
<ul>
<li><img src="/images/contract12.png" alt="contract"> <img src="/images/contract13.png" alt="contract"> </li>
</ul>
<p>创建react项目,打开项目，删除无用的文件</p>
<ul>
<li><img src="/images/contract14.png" alt="contract"> </li>
</ul>
<p>启动项目，保证项目的正确性</p>
<ul>
<li><p><img src="/images/contract15.png" alt="contract"> </p>
<pre><code>// 安装scatter sdk
// 这里使用的是eosjs1,尝试了多种方式，未找到eosjs2的使用方式，如有知道的同学，还请告知
npm i -S scatterjs-core  scatterjs-plugin-eosjs
</code></pre></li>
<li><p><img src="/images/contract16.png" alt="contract"></p>
</li>
</ul>
<p>改造项目的布局</p>
<pre><code>render() {
    return (
        &lt;div&gt;

            &lt;div&gt;
                &lt;button onClick={() =&gt; this.createTodo()}&gt;create todo&lt;/button&gt;
                &lt;button onClick={() =&gt; this.deleteTodo()}&gt;delete todo&lt;/button&gt;
                &lt;input type=&quot;text&quot; onChange={e =&gt; {
                    this.setState({
                        deleteId: Number.parseInt(e.target.value)
                    })
                }}/&gt;

                &lt;button onClick={() =&gt; this.completeTodo()}&gt;complete todo&lt;/button&gt;
                &lt;input type=&quot;text&quot; onChange={e =&gt; {
                    this.setState({
                        competedId: Number.parseInt(e.target.value)
                    })
                }}/&gt;
                &lt;button onClick={() =&gt; this.showTodo()}&gt;show todo&lt;/button&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;p&gt;below is data&lt;/p&gt;
                &lt;ul&gt;
                    {
                        this.state.rows.map((todo, index) =&gt; {
                            return &lt;li key={index}&gt;
                                &lt;p&gt;id : {todo.id}&lt;/p&gt;
                                &lt;p&gt;description : {todo.description}&lt;/p&gt;
                                &lt;p&gt;completed : {todo.completed}&lt;/p&gt;
                            &lt;/li&gt;
                        })
                    }
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    );
}
</code></pre><ul>
<li><p>引入scatter sdk </p>
<pre><code>import React, {Component} from &apos;react&apos;;
import ScatterJS from &apos;scatterjs-core&apos;;
import ScatterEOS from &apos;scatterjs-plugin-eosjs&apos;;
import Eos from &apos;eosjs&apos;;

ScatterJS.plugins(new ScatterEOS());

const network = {
blockchain: &apos;eos&apos;,
protocol: &apos;http&apos;,
host: &apos;jungle.cryptolions.io&apos;,
port: 18888,
chainId:         &apos;038f4b0fc8ff18a4f0842a8f0564611f6e96e8535901dd45e43ac8691a1c4dca&apos;
}
</code></pre></li>
</ul>
<ul>
<li>初始化</li>
</ul>
<pre><code>componentDidMount() {
    setTimeout(() =&gt; {
        this.init()
    }, 2000)
}

init() {
ScatterJS.scatter.connect(&apos;eos&apos;).then(connected =&gt; {
    if (!connected) return false;
    const scatter = ScatterJS.scatter;

    this.setState({
        scatter
    });
    alert(&quot;scatter load success&quot;)
});
}    
</code></pre><ul>
<li><p><img src="/images/contract17.png" alt="contract">    </p>
<p>  增加 曾 删 改 查的功能</p>
<pre><code>createTodo() {
this.state.scatter.getIdentity(requiredFields).then(() =&gt; {
    const account = this.state.scatter.identity.accounts.find(x =&gt; x.blockchain === &apos;eos&apos;);
    const eos = this.state.scatter.eos(network, Eos);
    const transactionPermission = {authorization: [`${account.name}@${account.authority}`]};
    const num = Math.floor(Math.random() * 100000);
    eos.contract(account.name).then(ins =&gt; {
        ins.create(account.name, num, &quot;this is &quot; + num, transactionPermission).then(res =&gt; {
            console.log(res)
        })
    })

}).catch(error =&gt; {
    console.error(error);
});
}
</code></pre></li>
<li><p><img src="/images/eos11.gif" alt="contract">    </p>
</li>
</ul>
<p>启动项目，看看演示效果。可以看见与eos网络的交互还是很流畅，速度也很快。到此，基于eos网络开发dapp的流程应该算结束了，谢谢你的阅读。</p>
<h4 id="eos智能合约开发-总结"><a href="#eos智能合约开发-总结" class="headerlink" title="eos智能合约开发 总结"></a>eos智能合约开发 总结</h4><blockquote>
<p>本打算下周更新此篇文章，恰好今天原来的计划取消了，那就不拖了，下周有下周的事情呢<br>这里有几点需要大家注意：</p>
</blockquote>
<ul>
<li>一定要有梯子，不然根本无从谈起</li>
<li>eos要求硬件比较高，这个需要自己准备了</li>
<li>一定要先理解eos中的相关概念，和以太坊还是有很大的区别的</li>
<li>一定要先跟着官网的hello走一遍</li>
<li>如果哪一步遇到问题了，可以反复翻看这两篇文章，你一定能够成功的</li>
</ul>
<h4 id="eos智能合约开发-源码"><a href="#eos智能合约开发-源码" class="headerlink" title="eos智能合约开发 源码"></a>eos智能合约开发 源码</h4><p>2018-11-15 22:18:58更新<br>[源码送上…]<br>(<a href="https://shaokun11.github.io/2018/11/15/%E5%9F%BA%E4%BA%8Eeos%E8%BF%9E%E6%8E%A5scatter%E5%BC%80%E5%8F%91dapp(%E4%B8%8B)%20%E7%BB%AD" target="_blank" rel="noopener">https://shaokun11.github.io/2018/11/15/%E5%9F%BA%E4%BA%8Eeos%E8%BF%9E%E6%8E%A5scatter%E5%BC%80%E5%8F%91dapp(%E4%B8%8B)%20%E7%BB%AD</a>)</p>
<h4 id="接下来的计划"><a href="#接下来的计划" class="headerlink" title="接下来的计划"></a>接下来的计划</h4><ul>
<li>继续分享智能合约的知识，主要是基于eos,tron,eth三个平台，希望能够帮助到大家</li>
<li>分享一些编程语言知识，eth 和 tron 是用solidity写合约，eos是用c++写，前端展示页面是用react写的 </li>
</ul>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。<br>（加好友时，请备注 区块链，谢谢）<br><img src="/common/wx.png" alt="jungle"> </p>
<p>当然也可以通过以下方式联系我<br>email_1: <a href="mailto:&#115;&#104;&#97;&#111;&#x6b;&#117;&#x6e;&#105;&#x6e;&#x67;&#64;&#103;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#109;" target="_blank" rel="noopener">&#115;&#104;&#97;&#111;&#x6b;&#117;&#x6e;&#105;&#x6e;&#x67;&#64;&#103;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#109;</a><br>email_2: <a href="mailto:&#115;&#x6b;&#x75;&#x6e;&#110;&#x79;&#64;&#x31;&#x36;&#51;&#46;&#99;&#111;&#109;" target="_blank" rel="noopener">&#115;&#x6b;&#x75;&#x6e;&#110;&#x79;&#64;&#x31;&#x36;&#51;&#46;&#99;&#111;&#109;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/13/基于eos连接scatter开发dapp(上)--补充 23.18.52/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/13/基于eos连接scatter开发dapp(上)--补充 23.18.52/" itemprop="url">学习eos dapp开发，看这篇就够了（上）--补充</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-13T23:23:17+08:00">
                2018-10-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="eos智能合约开发-在jungle上创建account-续"><a href="#eos智能合约开发-在jungle上创建account-续" class="headerlink" title="eos智能合约开发 在jungle上创建account 续"></a>eos智能合约开发 在jungle上创建account 续</h4><blockquote>
<p>之前由于网络的原因，导致中断了，那我们继续接着来。自带梯子最重要</p>
</blockquote>
<p><img src="/images/jungle03.png" alt="jungle"><br>打开网站，输入之前的信息如图所示,点击左下角create<br><img src="/images/jungle4.png" alt="jungle"><br>创建成功后，会返回这样的信息，看见最下面有绿色的应该就是成功了吧<br>接下来我们查看一下我们创建的account的信息，回到主页，选择account info，输入刚才创建的account ，我这里输入shaokun11113 ,点击 get<br><img src="/images/jungle5.png" alt="jungle"><br><img src="/images/jungle6.png" alt="jungle"><br>可以看到返回了我们创建账号的信息:    </p>
<ul>
<li>balance  什么都没有   </li>
<li>activity key 和 owner key为我们刚才创建账户的时候输入的key  </li>
<li>RAM 目前账号的RAM情况，这里可以看到刚创建账号就已经消耗了一部分的RAM,为什么呢？ 因为你的账号信息要占用内存啊，所以说，创建账号得找到一个有eos的账号的用户帮你创建，他要为你支付这部分费用</li>
<li>net Bandwidth 存了100个eos,目前没有使用</li>
<li>cpu Bandwidth 存了100个eos，目前没有使用</li>
</ul>
<p>由于作为dapp开发者，那么我们得准备点eos,那么接下来我们再去获取一点eos吧<br>回到主页，选择 faucet，输入 你的账号，如图所示，通过验证，选择send coins 就好<br><img src="/images/jungle7.png" alt="jungle"><br>返回的结果如上所示，有兴趣的同学可以仔细看看这些内容。<br>那么我们如何知道我们是否收到了eos呢？<br>还是回到主页，进入 account info查询就好</p>
<p><img src="/images/jungle8.png" alt="jungle"> </p>
<p> 这里注意一下 balance 那一项就好，可以看到已经有100个eos和100个jungle token了</p>
<h4 id="eos智能合约开发-导入Account到scatter中"><a href="#eos智能合约开发-导入Account到scatter中" class="headerlink" title="eos智能合约开发 导入Account到scatter中"></a>eos智能合约开发 导入Account到scatter中</h4><blockquote>
<p>经过上一步骤，我们已经创建好了账户，接下来就讲账户导入到scatter中吧。在scatter中，这里叫做identity（身份）</p>
</blockquote>
<p><img src="/images/scatter17.png" alt="jungle"><br>进入scatter，选择身份。点击左下角的编辑的icon<br>如果你关闭过浏览器，请输入最开始的密码进入就好，如果忘记了，请输入助记词找回，如果丢了，就从头来一遍就好.<br><img src="/images/scatter18.png" alt="jungle"><br>这里我们注意一下 账户选项中的内容就好<br><img src="/images/scatter19.png" alt="jungle"><br>这里都是选择题，账户的第一项勾选我们创建网络时输入的名字，第二项勾选我们生成密匙对的名字就好，点击导入<br><img src="/images/scatter23.png" alt="jungle"><br>如果你看到了这个结果，不好意思，我也不知道你哪一步有问题。你可以从头开始再来一遍就好<br><img src="/images/scatter20.png" alt="jungle"><br>当然，我希望的是你看到的这个界面，通常我们选择active账号，然后点击右上角保存按钮<br><img src="/images/scatter21.png" alt="jungle"><br>回到这个界面，可以看到我们刚才创建的账户已经导入成功了，这里多一步的设置，把此账户设置为scatter的默认账户，这样以后调用scatter的时候就会默认选择此账户进行智能合约的调用了  勾选左下角的那个小圆圈的icon<br><img src="/images/scatter22.png" alt="jungle"><br>我们就可以看到我们账户的信息啦</p>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<p><strong>这样一点点的敲下来，内容还是蛮多的。本打算一次写完，结果遇到网络的问题，暂停了一会，这篇文章算是对第一篇的补充吧。到目前为止，我们只是创建好了账户，还没有涉及到dapp的开发，接下来的具体怎么开发dapp估计要等到下周了吧。</strong></p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。<br>（加好友时，请备注 区块链，谢谢）<br><img src="/common/wx.png" alt="jungle"> </p>
<p>当然也可以通过以下方式联系我<br>email_1: <a href="mailto:&#x73;&#x68;&#x61;&#111;&#x6b;&#x75;&#110;&#x69;&#x6e;&#103;&#x40;&#x67;&#x6d;&#97;&#x69;&#x6c;&#x2e;&#99;&#x6f;&#109;" target="_blank" rel="noopener">&#x73;&#x68;&#x61;&#111;&#x6b;&#x75;&#110;&#x69;&#x6e;&#103;&#x40;&#x67;&#x6d;&#97;&#x69;&#x6c;&#x2e;&#99;&#x6f;&#109;</a><br>email_2: <a href="mailto:&#x73;&#107;&#x75;&#x6e;&#x6e;&#x79;&#x40;&#49;&#54;&#51;&#x2e;&#x63;&#x6f;&#x6d;" target="_blank" rel="noopener">&#x73;&#107;&#x75;&#x6e;&#x6e;&#x79;&#x40;&#49;&#54;&#51;&#x2e;&#x63;&#x6f;&#x6d;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/13/基于eos连接scatter开发dapp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/13/基于eos连接scatter开发dapp/" itemprop="url">学习eos dapp开发，看这篇就够了（上）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-13T15:14:24+08:00">
                2018-10-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="eos安装-方式1"><a href="#eos安装-方式1" class="headerlink" title="eos安装 方式1"></a>eos安装 方式1</h4><p><a href="https://developers.eos.io/eosio-home/docs/setting-up-your-environment" target="_blank" rel="noopener">eos安装1</a><br>这是eos官网推荐的安装方式。</p>
<p>官网推荐docker，可以减少不必要的麻烦 ，而且步骤超级详细，超级详细，要是安装不成功的话，请确认是否使用mac电脑或者官网推荐的其他操作系统，千万不要使用Windows系统来玩eos,因为官方说过不支持的哈。</p>
<h4 id="eos安装-方式2"><a href="#eos安装-方式2" class="headerlink" title="eos安装 方式2"></a>eos安装 方式2</h4><p><a href="https://developers.eos.io/eosio-nodeos/docs/getting-the-code" target="_blank" rel="noopener">eos 安装2</a> </p>
<pre><code>git clone https://github.com/EOSIO/eos --recursive
cd eos
./eosio_build.sh
./eosio_install.sh
// 从源码编译 准备好梯子很重要
</code></pre><h4 id="eoscdt安装"><a href="#eoscdt安装" class="headerlink" title="eoscdt安装"></a>eoscdt安装</h4><p><a href="https://developers.eos.io/eosio-home/docs/installing-the-contract-development-toolkit" target="_blank" rel="noopener">eosio.cdt 安装1</a> 这里遵循官网的步骤</p>
<pre><code>git clone --recursive https://github.com/eosio/eosio.cdt --branch     v1.2.1 --single-branch
cd eosio.cdt 
./build.sh eos
sudo ./install.sh
//这是新的生成wasm 和 abi的工具，以后官方会维护的，之前方式会在后续被移除 
</code></pre><p><a href="https://developers.eos.io/eosio-home/docs/installing-the-contract-development-toolkit" target="_blank" rel="noopener">eosio.cdt 安装2</a> 这里是最新的步骤</p>
<h4 id="eos安装-方式总结"><a href="#eos安装-方式总结" class="headerlink" title="eos安装 方式总结"></a>eos安装 方式总结</h4><p>简单，超级简单。<br>但是，受限于我们得环境，自备梯子是成功的第一步，第二步就是要一个适合的硬件，两者缺一不可。</p>
<h4 id="eos智能合约开发-开发体会"><a href="#eos智能合约开发-开发体会" class="headerlink" title="eos智能合约开发 开发体会"></a>eos智能合约开发 开发体会</h4><p>最好的学习资料就是官方提供的资料了，而且eos官方的资料具详细，在此送上<br><a href="https://developers.eos.io/" target="_blank" rel="noopener">eos官网</a></p>
<p>安装不是我要说的重点，过程艰辛就不说了，有问题Google或者度娘吧，我这里主要想要与大家分享的是如何使用scatter连接eos的测试网或者主网进行dapp的开发。  </p>
<p>上面的环境安装了可以启动本地的节点来进行测试，官网也是如此，而现在我能够搜索到的文章基本上也是基于本地节点使用命令行来进行开发，这样只能保证你学习开发eos的流程，但是具体怎样开发dapp你可能还是不清楚，因为你不知道如何连接scatter，如何与智能合约进行交互，所以这篇文章重点解决的问题是在这里。</p>
<p>这里再区分一下钱包开发和dapp的开发。钱包开发需要用户提供他的私钥给你，或者你创建好给用户。而我们此处所要使用的是官方的钱包scatter来进行开发dapp，不需要用户提供私钥给我们，他只需要接入官方提供的scatter就好，如果你有以太坊的经验，这就是metamask</p>
<h4 id="eos智能合约开发-scatter安装"><a href="#eos智能合约开发-scatter安装" class="headerlink" title="eos智能合约开发 scatter安装"></a>eos智能合约开发 scatter安装</h4><p>scatter，官方提供的eos钱包，这样用户才会放心把他们的密钥放进去，所以先安装它吧<br>scatter是chrome的插件，所以你先得安装它<a href="https://www.google.com/chrome/" target="_blank" rel="noopener">chrome浏览器下载</a><br>接下来把scatter 插件安装上 <a href="https://chrome.google.com/webstore/search/scatter?hl=zh-CN" target="_blank" rel="noopener">scatter Chrome插件</a>  </p>
<p><img src="/images/scatter00.png" alt="scatter"><br>搜索scatter安装就好，我这里是安装好的界面  </p>
<ul>
<li><img src="/images/scatter0.png" alt="scatter"><br>点击插件的scatter图标弹出如图界面，输入你的钱包密码然后点击生成钱包就好   </li>
<li><img src="/images/scatter1.png" alt="scatter"><br>助记词，抄写下来吧，以后恢复钱包用的   </li>
<li><img src="/images/scatter2.png" alt="scatter"><br>这里我选择skip basic setup，后续再来设置也是可行的  </li>
<li><img src="/images/scatter3.png" alt="scatter"><br>这个界面，点击右上角的⚙图标  </li>
<li><img src="/images/scatter4.png" alt="scatter"><br>这个界面，选择language，设置语言  </li>
<li><img src="/images/scatter5.png" alt="scatter"><br>设置好后，切换回来，成功了  <h4 id="eos智能合约开发-使用scatter生成密匙对"><a href="#eos智能合约开发-使用scatter生成密匙对" class="headerlink" title="eos智能合约开发 使用scatter生成密匙对"></a>eos智能合约开发 使用scatter生成密匙对</h4></li>
</ul>
<ol>
<li>经过以上的步骤，scatter已经安装好了，也就是我们创建了钱包，但是我们的钱包还没有内容的，为什么呢？这里我还是看看官网的这张图吧<br><img src="/images/eosio2.png" alt="eos钱包关系"></li>
<li>基于上张图的方式，我们得创建一对密匙，那就按照接下来的方式做吧<ul>
<li><img src="/images/scatter6.png" alt="scatter"><br>点击密匙对，点击新建</li>
<li><img src="/images/scatter7.png" alt="scatter"><br>点击生成密匙对  </li>
<li><img src="/images/scatter8.png" alt="scatter"><br>重点，记住这里的步骤不能省略<br>重点，记住这里的步骤不能省略<br>重点，记住这里的步骤不能省略<br>点击   复制  </li>
<li><img src="/images/scatter9.png" alt="scatter"><br>新开一个文本文档，点击粘贴，这样就把生成好的密匙对保存下来了，待会要用的  </li>
<li><img src="/images/scatter10.png" alt="scatter"><br>为这个密匙对取个名字，随便写，随意几好 </li>
<li><img src="/images/scatter11.png" alt="scatter"><br>完成了这些步骤，你应该能够看到上面的信息，如果没有，就再从头来一遍了。<br>这样我们的密匙对就创建好了，但是只是在本地创建好了的啊，怎么连接到测试网络和主网络呢？  </li>
</ul>
</li>
</ol>
<h4 id="eos智能合约开发-设置scatter连接-jungle-test-net"><a href="#eos智能合约开发-设置scatter连接-jungle-test-net" class="headerlink" title="eos智能合约开发 设置scatter连接 jungle test net"></a>eos智能合约开发 设置scatter连接 jungle test net</h4><ul>
<li><img src="/images/scatter5.png" alt="scatter net setting"><br>回到这个界面，选择设置图标，选择</li>
<li><img src="/images/scatter12.png" alt="scatter net setting"><br>这个界面选择网络  </li>
<li><img src="/images/scatter13.png" alt="scatter net setting"><br>这里可以看到已经有一个eos和eth的主网的网络节点，那么我们来把我们的测试网络的节点加入进去，点击右上角的新建  </li>
<li><img src="/images/scatter14.png" alt="scatter net setting"><br>这个界面就是设置网络所需要的一些必要信息，我们一个一个来填  <ol>
<li>由于我们是连接eos网络，所以这里第一项默认不变，下拉框可以选择eth,以后还可以支持tron</li>
<li>名称： 随便写一个，你自己记得住就好  </li>
<li>改成http,因为我们测试网络的endpoint就是用的这个协议，照改就好。</li>
<li>域名或ip地址：jungle.cryptolions.io    </li>
<li>端口 ：18888</li>
<li>chaninId:  038f4b0fc8ff18a4f0842a8f0564611f6e96e8535901dd45e43ac8691a1c4dca</li>
<li>如果你对以上填入的这些信息想知道为什么，那么可以补一下rpc协议，不想了解直接填入就好，以后就懂了  </li>
</ol>
</li>
<li><img src="/images/scatter15.png" alt="scatter net setting"><br>按照上述的步骤填完后，信息如上，点击右上角保存  </li>
<li><img src="/images/scatter16.png" alt="scatter net setting"><br>没有问题的话，会看到如上红框的显示内容，代表我们得测试网络已经设置好了</li>
</ul>
<h4 id="eos智能合约开发-在jungle测试网络上创建account"><a href="#eos智能合约开发-在jungle测试网络上创建account" class="headerlink" title="eos智能合约开发 在jungle测试网络上创建account"></a>eos智能合约开发 在jungle测试网络上创建account</h4><blockquote>
<p>为什么要创建账户呢？这就是eos的一大特点。BM说，你创建了一个密匙对，谁记得住呢，所以就设计了一个这样的账户系统，这个账户 长12位，只能由a-z12345这些字符组成。简而言之，方便记忆。</p>
</blockquote>
<ul>
<li><a href="http://jungle.cryptolions.io/#home" target="_blank" rel="noopener">jungle net account </a><br>打开jungle测试网络地址</li>
<li><img src="/images/jungle1.png" alt="jungle net account "><br>来到jungle的主页，点击 Create Account  </li>
<li><img src="/images/jungle2.png" alt="jungle net account ">  <ol>
<li>Account name : 看清楚要求 <em>小写字母 加上12345，总共12个字符</em><br>这里我写作 shaokun11113</li>
<li>owner public key : 将我们用scatter生成的那个密匙对的公钥填入这里</li>
<li>active public key: 将我们用scatter生成的那个密匙对的公钥填入这里</li>
<li>我这里用一对就好，在主网申请账号的时候建议使用两对密匙对。想要知道为什么？可以看看eos第二版的白皮书</li>
</ol>
</li>
<li><img src="/images/jungle03.png" alt="jungle net account "><br>这次我就这样填写，然后人机验证，通过后点击左下角的create,确保网络质量优良  </li>
</ul>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<p><strong>这里我的网络质量太差了。。。先写到这里，，， 请继续关注第二篇</strong>  </p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。<br>（加好友时，请备注 区块链，谢谢）<br><img src="/common/wx.png" alt="jungle"><br>当然也可以通过以下方式联系我<br>email_1: <a href="mailto:&#x73;&#x68;&#97;&#x6f;&#107;&#x75;&#x6e;&#x69;&#110;&#103;&#64;&#x67;&#x6d;&#x61;&#x69;&#x6c;&#46;&#99;&#x6f;&#x6d;" target="_blank" rel="noopener">&#x73;&#x68;&#97;&#x6f;&#107;&#x75;&#x6e;&#x69;&#110;&#103;&#64;&#x67;&#x6d;&#x61;&#x69;&#x6c;&#46;&#99;&#x6f;&#x6d;</a><br>email_2: <a href="mailto:&#115;&#107;&#x75;&#x6e;&#x6e;&#x79;&#x40;&#x31;&#54;&#x33;&#46;&#x63;&#111;&#x6d;" target="_blank" rel="noopener">&#115;&#107;&#x75;&#x6e;&#x6e;&#x79;&#x40;&#x31;&#54;&#x33;&#46;&#x63;&#111;&#x6d;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/02/关于bancor的理解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/02/关于bancor的理解/" itemprop="url">带你以通俗易懂的小例子了解bancor</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-02T14:33:22+08:00">
                2018-10-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="bancor的简单概述"><a href="#bancor的简单概述" class="headerlink" title="bancor的简单概述"></a>bancor的简单概述</h5><blockquote>
<p>bancor是一种算法用于区块链的一种新的token的交易方式，目的是解决长尾的问题，增加ERC20的流通。长尾简单理解就是99%和1%的关系，即1%的token在大家的认知中有实际价值，而99%的token是没有的。那么通过bancor协议就是可以解决这99%的token，也可以给一个机会，让他们也有实际的价值。<br>具体可访问<a href="https://github.com/bancorprotocol/contracts" target="_blank" rel="noopener">bancor github repo</a>，这里有详细的介绍和白皮书</p>
</blockquote>
<h5 id="bancor名词展示"><a href="#bancor名词展示" class="headerlink" title="bancor名词展示"></a>bancor名词展示</h5><p><em>以下资料来自网络</em>  <strong>start</strong></p>
<p>Token的供应量【Smart Token’s Supply】，简称Supply；</p>
<p>Token的价格【Smart Token’s Price 】，简称Price；</p>
<p>Token的总市值【Smart Token’s Total Value】，简称TotalValue；</p>
<p>储备金余额【Connector Balance】，简称Balance；</p>
<p>储备金固定比率【Connector Weight】，简称CW。</p>
<p>计算公式如下：</p>
<pre><code>CW = Balance / TotalValue;

TotalValue = Price * Supply;

Price = Balance /（Supply * CW）
</code></pre><p>举例：若当前AToken的发行量为1000，报价为0.5个ETH兑换1个AToken，那么AToken的总价值为500个ETH，但是储备金余额可能并没有500个ETH，比如为250个ETH，那么CW则为0.5（50%)  </p>
<p>Token买入计算公式：</p>
<pre><code>Token_Return = Supply *（（1 + ETH_Amount / Balance）^ CW - 1）
//此公式的证明可以通过查看白皮书
</code></pre><blockquote>
<p>例如 若当前AToken的发行量为1000，储备金余额为250个ETH，CW为0.5，那么当前的报价则为0.5个ETH兑换1个AToken；现在Bob想花750个ETH购买AToken，带入公式：Token_Return = 1000 *（（1 + 750 / 250）^ 0.5 - 1）= 1000</p>
</blockquote>
<blockquote>
<p>即Bob花了750个ETH购买了1000个AToken，本次购买的平均价格为0.75个ETH兑换1个AToken。<br>Bob的购买行为推高了AToken的报价。若Bob接着购买同样数量的AToken，则需要付出更多的ETH代价，每一笔购买都会继续推高AToken的报价。</p>
</blockquote>
<p>Token卖出计算公式：</p>
<pre><code>ETH_Return = Balance *（1 - （1 - Token_Amount / Supply）^ （1 / CW））
</code></pre><blockquote>
<p>在Bob的那笔交易完成后，AToken的发行总量为2000个，储备金余额为1000个ETH，CW维持不变、仍然为0.5，那么通过公式可以计算当前的报价为1个ETH兑换1个AToken；现在Alice想卖掉1000个AToken，带入公式：ETH_Return = 1000 *（1 - （1 - 1000 / 2000）^ （1 /0.5））= 750</p>
</blockquote>
<blockquote>
<p>即Alice 卖掉了1000个AToken，获得了750个ETH，本次购买的平均价格为0.75个ETH兑换1个AToken。因为Bob的购买行为推高了AToken的报价，而Alice是在Bob的购买行为之后卖掉了AToken，所以Alice卖到了相对较高的价位。假如没有Bob的购买行为，回到AToken的供应量为1000的那个时候，Alice卖掉全部的AToken，也只能获得250个ETH  </p>
</blockquote>
<p>智能代币(Smart Tokens)</p>
<blockquote>
<p>智能代币是Bancor协议的核心。它们的运作类似于常规代币，在ETH区块链上使用的符合ERC20标准[5]，但也要包含额外的逻辑，即允许用户通过它的智能合约直接购买和出售代币，价格通过程序自动调整以反映供求关系。实际上，智能代币拥有一种内置的流动性机制，确保它们可以持续地为兑换为其他代币。  </p>
</blockquote>
<p>智能代币连接器(Smart Token connectors)  </p>
<blockquote>
<p>智能代币连接器可以被视为分布式、自主、透明和可预测的做市商，而不是交易所。智能代币通过程序自动调整它们的价格，来管理它们的连接器准备金，以保持它们与智能代币的总市值之间的比率是恒定的。<br>锚定代币(connected token)<br>每个智能代币都配置了连接器模块，这些模块持有它连接的另一个代币作为准备金（例如，BNT智能代币有一个连接到ETH的连接器，它持有ETH作为准备金）。ETH此时就是连接器代币。</p>
</blockquote>
<p>代币网络(token network)</p>
<blockquote>
<p>智能代币可以实现自己和它们的连接代币之间进行即时兑换。这个功能足以使智能代币即时兑换为一定数量的以类似的方式连接到同一网络的任何其他代币。通过这种方式，智能代币可以连接到无限数量的代币，从而创建一个分布式的流动性网络，该网络可能由数百万个代币组成，这些代币都可以以不断计算的价格自动地相互兑换。</p>
</blockquote>
<p>中继代币(Relay Token)  </p>
<blockquote>
<p>具有两个连接器的智能代币，其总CW恰好为100%，其功能类似于分布式代币兑换币对。中继代币允许用户在两个连接代币之间互相兑换，通过两步操作实现，即购买一种代币，立即出售另外一种代币。</p>
</blockquote>
<p>流动性代币(Liquid Tokens)</p>
<blockquote>
<p>具有组合连接器总权重低于100%（更典型的低于20%）的智能代币成为流动性代币。可能有一个或者多个连接器。例如，BTN具有单个权重为10%的ETH连接器。流动性代币可以使用连接器代币买卖（使用Bancor公式计算它相对于连接代币的价格），并且可以自适应调节供应量，在购买时增加，出售时减少。  </p>
</blockquote>
<p>代理代币(Proxy Token)</p>
<blockquote>
<p>具有一个连接器占100%权重的智能代币。</p>
</blockquote>
<p>组合代币(Array Token)</p>
<blockquote>
<p>具有三个或者更多连接器权重为100%的智能代币。</p>
</blockquote>
<p>糖果代币(Bounty Tokens)</p>
<blockquote>
<p>具有单个尚未激活连接器的智能代币（当前连接器准备金为0），可以向早起持有者（例如社区支持者）发放将来会发行的代币。</p>
</blockquote>
<p>网络代币(Network Tokens)</p>
<blockquote>
<p>由多个(&gt;2)智能代币持有作为连接代币的智能代币,BNT就是一个网络代币，也是一个流动性代币。</p>
</blockquote>
<p>交易者</p>
<blockquote>
<p>持有、兑换和支付智能代币的终端用户</p>
</blockquote>
<p>智能代币发行者</p>
<blockquote>
<p>发行智能代币，配置初始供应量、价格、连接器权重CW和管理智能代币初始发行的人员、公司、社区、组织或基金会。还包括将现有ERC20代币连接到Bancor网络的中继代币的创建者。</p>
</blockquote>
<p>资产代币化者</p>
<blockquote>
<p>将代理代币或者组合代币映射到实体资产或者其他区块链上代币的创建者。这允许智能代币连接到更广泛的资产，如比特币、法定货币、黄金或其他新兴的区块链代币。</p>
</blockquote>
<p>套利者</p>
<blockquote>
<p>监控Bancor流动性网络与外部交易所或者其他智能代币的价格，并且通过套利消除价差的交易者。套利者通过消除价差获得奖励，因此是Bancor生态系统的重要参与者。 </p>
</blockquote>
<p><strong><em>end</em></strong></p>
<h5 id="我之理解"><a href="#我之理解" class="headerlink" title="我之理解"></a>我之理解</h5><pre><code>cw的理解可以参考很那张很经典的图
cw&lt;50%:price与supply的变化可理解为指数函数y = x^N 的形式变化
cw=50%:price与supply的变化可理解为一次函数y = ax (a&gt;0)的形式变化
cw&gt;50%:price与supply的变化可理解为对数函数y = y=logN(x)的形式变化
cw=100%:price与supply的变化可理解为常数函数y = x的形式变化  
</code></pre><ol>
<li>我发行一个smart token（暂且叫sk）,总量1000个 ，即supply= 1000 sk</li>
<li>预估一下我这个项目的价值，暂且估计价值1000个eth ，即TotalValue = 1000 eth</li>
<li>而我只有100个eth,那作为储备金，剩余的向大家融资吧,即balance = 100 eth</li>
<li>设定cw = 10%，</li>
<li>根据算法，得到price = 1 sk/eth，</li>
<li>到此，可理解为我用100eth以单价为10买了1000 sk,</li>
<li>使用100 eth买入，根据买入公式，得到(（1+（100/100））^0.1 - 1) <em> 1000= 0.0718 </em>  1000 = 71.8个sk，</li>
<li>当执行上笔交易后，cw是不会变得，其余的会动态调整。那么此时的sk supply = 1071.8 sk,balance = 200 eth，price = 1.866 sk / eth</li>
<li>这里可以看到买入100个后，一个sk价值1.866个eth,价格上涨了呢。这里有兴趣的同学可以试试连续分批次买10次，每次10个eth，可以看到价格的变化,最终的结果也是一样的，这就是bancor算法保证的结果</li>
<li>再继续使用100eth买入，根据买入公式，得到(（1+（100/200））^0.1 - 1) <em> 1071.8= 0.0414 </em>  1071.8 = 44.37个sk，这样后来买的价格就比之前的高了，获得的sk就会少，也就是价格高了</li>
<li>supply = 1116.7 sk,balance = 300 eth，price = 26.86 sk/eth 单价已经翻了20倍了</li>
<li>卖出50 sk，根据卖出公式 300 *（1 - 50/1116.7）^(1/0.1) = 189.7488 eth   </li>
<li>额，初始值设定的不恰当，整个流程算出来的结果有点恐怖，有兴趣的同学可以按照流程调整一下初始值哈0.0</li>
<li>这里可能有同学会问了，我刚使用100eth获得44个sk,我马上又卖出50个sk可以得到189个eth，大赚了啊。理论上是成立的，但是你得保证你这两个操作中间没有其他人的卖出哈（买入你就赚得越多），其他人卖出之后，你再去卖价格就低了，所以得自己评估风险哦  </li>
</ol>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<p>小结：</p>
<ul>
<li>控制cw的变化，可以控制token的价格的走势</li>
<li>买入,会提高smart token的价格，卖出会降低smart token的价格，具体变化由cw的决定</li>
<li>缺点：这些数据都是采用智能合约编写的，无法改变。但是项目方可以更改cw的值，从而控制整个token的价格走势</li>
<li>优点：你如果持有smart token是可以随时和储备金类型的token进行买卖的。这都是由智能合约自动执行，这点可以相对于传统的1co有着更好的安全，至少你持有的token有着更好的流通性，随时都可以流通，也可以换取其他的token或者储备金的token  </li>
</ul>
<h5 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h5><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。<br>（加好友时，请备注 区块链，谢谢）<br><img src="/common/wx.png" alt="jungle"> </p>
<h5 id="资料更新-2018-10-13-15-50-20"><a href="#资料更新-2018-10-13-15-50-20" class="headerlink" title="资料更新 2018-10-13 15:50:20"></a>资料更新 2018-10-13 15:50:20</h5><p>更新一下，这里补上bancor的经典cw图，便于大家理解。<br><img src="/bancor/bancor.png" alt="cw"><br>根据这张图中的曲线，那么你所持有的币的价值就是等于曲线上任意两点作x轴 所形成的面积。所以任何一点点的买入卖出都会影响整个智能代币的价格<br>另外附上bancor的白皮书<br><a href="https://storage.googleapis.com/website-bancor/2018/04/01ba8253-bancor_protocol_whitepaper_en.pdf" target="_blank" rel="noopener">bancor 白皮书 英文版</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/19/ERC998接口的理解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/19/ERC998接口的理解/" itemprop="url">全新的加密NTF表现形式---ERC998</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-19T23:05:41+08:00">
                2018-09-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="ERC998"><a href="#ERC998" class="headerlink" title="ERC998"></a>ERC998</h5><blockquote>
<p>在开始之前，你可能需要了解一下区块链，比特币，以太坊，ERC20和ERC721的相关知识,因为整篇文章也是在此基础上的一个应用的开始。</p>
</blockquote>
<p>ERC998目前状态Draft,创建于2018/7/7<br>具体信息可访问<a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-998.md" target="_blank" rel="noopener">ERC998</a>。<br>特性：可组合（composable）。ERC20和ERC721仅仅是单一的物品的应用，而ERC998可以组合不同的ERC721和ERC20，使之产生更丰富的应用。可以类比主机（ERC721） +  显示器（ERC20）+ 外设（ERC721）= 电脑（ERC998）；通过这样的组合我们就能够创建出更加复杂，高级的功能。</p>
<h5 id="ERC998的两种实现"><a href="#ERC998的两种实现" class="headerlink" title="ERC998的两种实现"></a>ERC998的两种实现</h5><p>ComposableTopDown和ComposableBottonUp，本次结合我实际的应用只讲介绍前者，具体的不同可以参考官网，当然这里有一篇作者更详细的介绍:<br><a href="https://hackernoon.com/top-down-and-bottom-up-composables-whats-the-difference-and-which-one-should-you-use-db939f6acf1d" target="_blank" rel="noopener">Top-Down and Bottom-Up Composables, What’s the Difference and Which One Should You Use?</a></p>
<h5 id="ERC998接口分析"><a href="#ERC998接口分析" class="headerlink" title="ERC998接口分析"></a>ERC998接口分析</h5><p>原作者已经写得非常详细了，具体就不在具体分析了。这里结合avatar（ERC998的实现的虚拟形象）和clothes（ERC721的实现的衣服）简单的看看ComposableTopDown的实现吧。（ComposableBottonUp的原理也类似）  </p>
<p><em>interface ERC998ERC721TopDown</em></p>
<pre><code>event ReceivedChild(address indexed _from, uint256 indexed _tokenId, address indexed _childContract, uint256 _childTokenId)
</code></pre><p>当avatar接收到一件clothes会触发的一个事件<br> _from : clothes的原始owner address<br> _tokenId : 哪一个avatar来穿这件衣服，即avatar id<br> _childContract: clothes contract address<br>_childTokenId:  哪一件衣服，即clothes id  </p>
<pre><code>event TransferChild(uint256 indexed tokenId, address indexed _to, address indexed _childContract, uint256 _childTokenId);
</code></pre><p>当avatar脱下一件clothes时会发出的一个事件<br>tokenId : 将要脱下clothes的avatar id<br>_to : 接收clothes address,在项目中<br>_childContract： clothes 合约地址<br>_childTokenId： clothes id</p>
<pre><code>function rootOwnerOf(uint256 _tokenId) external view returns (bytes32 rootOwner);
</code></pre><p>rootOwner:获得clothes的owner  address，实际上是调用的下面的这个函数<br>返回的是加上ERC998的特殊值加上owner的address，可以通过address（_rootOwner）得到owner的address<br>_tokenId  需要查找的avatar id</p>
<pre><code>function rootOwnerOfChild(address _childContract, uint256 _childTokenId) external view returns (bytes32 rootOwner);
</code></pre><p>rootOwner：cloth对应的owner address<br>这里注意一下，此处返回的 root owner有可能是contract address ，也有可能是user address。根据作者的设计总共有四种可能<br>_childContract ： clothes contract address<br>_childTokenId ： clothes id</p>
<pre><code>function ownerOfChild(address _childContract, uint256 _childTokenId) external view returns (bytes32 parentTokenOwner, uint256 parentTokenId);  
</code></pre><p>parentTokenOwner: 返回的是加上ERC998的特殊值加上owner address<br>parentTokenId : avatar id<br>_childContract: clothes contract address<br>_childTokenId： clothes id</p>
<pre><code>function onERC721Received(address _operator, address _from, uint256 _childTokenId, bytes _data) external returns (bytes4);
</code></pre><p>bytes4: 返回的一个bytes4的值 用于更新其他NTF到avatar时的一个回调方法，告诉avatar转入了这个数据，将此数据添加到avatar的数据中.<br><strong>这里使用NTF代替其他ERC721 token</strong><br>_operator: 执行这个操作的address<br>_from : 原始NTF 拥有者的 address<br>_childTokenId： NTF id<br>_data : 附加数据</p>
<pre><code>function transferChild(uint256 _fromTokenId, address _to, address _childContract, uint256 _childTokenId) external;
function safeTransferChild(uint256 _fromTokenId, address _to, address _childContract, uint256 _childTokenId) external;
function safeTransferChild(uint256 _fromTokenId, address _to, address _childContract, uint256 _childTokenId, bytes _data) external
</code></pre><p>这是三个重载的方法，加上safe是为了确保转入的合约地址有类似于<em>onERC721Received</em>的方法进行回调，确保token不会丢失。如果转入的合约地址没有注册次方法，那么将不会转入成功，从而回退转移操作，保证NTF的安全。<br>如果转入的是user address，那么直接调用第一个方法即可。<br>这些方法均会触发TransferChild这个事件<br>_fromTokenId :  avatar id<br>_to ：接受clothes address<br>_childContract : clothes contract address<br>_childTokenId ： 将要进行转出的clothes id  </p>
<pre><code>function transferChildToParent(uint256 _fromTokenId, address _toContract, uint256 _toTokenId, address _childContract, uint256 _childTokenId, bytes _data) external;
</code></pre><p>如果avatar含有ERC998 ComposableTopDown的token,可以通过这个方法进行转移  </p>
<pre><code>function getChild(address _from, uint256 _tokenId, address _childContract, uint256 _childTokenId) external;
</code></pre><p>用于用户user自己转入clothes到avatar中，注意与<em>onERC721Received</em>进行比较。<br>_from : clothes拥有者的address<br>_tokenId ：转进给哪一个avatar，即avatar id<br>_childContract :  clothes contract address<br>_childTokenId ： clothes id</p>
<p><em>interface ERC998ERC721TopDownEnumerable</em>   </p>
<pre><code>function totalChildContracts(uint256 _tokenId) external view returns (uint256);
</code></pre><p>获取avatar下面有多少种类的NFT，目前可以知道我们的项目只有clothes，所以返回1<br>_tokenId : avatar id</p>
<pre><code>function childContractByIndex(uint256 _tokenId, uint256 _index) external view returns (address childContract);
</code></pre><p>获取NFT的contract address。目前我们的Bitizen中，仅有clothes，所以结果只有clothes的contract address<br>_tokenId : avatar id<br>_index :  从0开始的下标</p>
<pre><code>function totalChildTokens(uint256 _tokenId, address _childContract) external view returns (uint256);
</code></pre><p>获取NTF的数量，即获取clothes的数量<br>_tokenId : avatar id<br>_childContract :  NTF contract address，即clothes的合约地址</p>
<pre><code>function childTokenByIndex(uint256 _tokenId, address _childContract, uint256 _index) external view returns (uint256 childTokenId);
</code></pre><p>根据<em>totalChildTokens</em>的返回值，获取具体的每一个NTF id<br>_tokenId : avatar id<br>_childContract :  NTF contract address，即clothes的合约地址<br>_index ： 从0 开始的索引，小于<em>totalChildTokens</em>的返回值</p>
<pre><code>interface ERC998ERC20TopDownEnumerable {
function totalERC20Contracts(uint256 _tokenId) external view returns (uint256);
function erc20ContractByIndex(uint256 _tokenId, uint256 _index) external view returns (address);}
interface ERC20AndERC223 {
function transferFrom(address _from, address _to, uint _value) external returns (bool success);
function transfer(address to, uint value) external returns (bool success);
function transfer(address to, uint value, bytes data) external returns (bool success);
function allowance(address _owner, address _spender) external view returns (uint256 remaining);}
</code></pre><p>ERC20集成到ERC998的interface，可按照ERC721的理解，就不一一讲解了</p>
<pre><code>interface ERC998ERC721BottomUp {
function transferToParent(address _from, address _toContract, uint256 _toTokenId, uint256 _tokenId, bytes _data) external;}
</code></pre><p>声明ComposableBottonUp的接口，用于<em>transferChildToParent</em><br>到此为止，ComposableTopDown的对外开放的接口已经分析完毕了。</p>
<h5 id="ERC998实际运用"><a href="#ERC998实际运用" class="headerlink" title="ERC998实际运用"></a>ERC998实际运用</h5><p><a href="https://www.bitguild.com/presale/bitizens" target="_blank" rel="noopener">Bitizens</a>在这里，你可以找到第一个基于ERC998创建的一款3D游戏，你可以免费创建一个只属于你自己的bitizen.</p>
<h5 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h5><p>这篇文章仅仅分析了ERC998的标准接口，当然其中也涉及到ERC721和ERC20的一些知识，希望能够给将要进入dapp的开发者提供一点点帮助。</p>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。<br>（加好友时，请备注 区块链，谢谢）<br><img src="/common/wx.png" alt="jungle"><br>email_1: <a href="mailto:&#115;&#104;&#97;&#x6f;&#107;&#x75;&#110;&#x69;&#x6e;&#x67;&#64;&#x67;&#109;&#x61;&#x69;&#x6c;&#46;&#x63;&#111;&#109;" target="_blank" rel="noopener">&#115;&#104;&#97;&#x6f;&#107;&#x75;&#110;&#x69;&#x6e;&#x67;&#64;&#x67;&#109;&#x61;&#x69;&#x6c;&#46;&#x63;&#111;&#109;</a><br>email_2: <a href="mailto:&#115;&#107;&#x75;&#110;&#x6e;&#121;&#64;&#49;&#x36;&#51;&#46;&#99;&#x6f;&#109;" target="_blank" rel="noopener">&#115;&#107;&#x75;&#110;&#x6e;&#121;&#64;&#49;&#x36;&#51;&#46;&#99;&#x6f;&#109;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">shaokun</p>
              <p class="site-description motion-element" itemprop="description">记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同进步</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shaokun</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        
<div class="busuanzi-count">
 <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 访问总量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
