<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同探讨">
<meta name="keywords" content="eos,eth,tron,区块链">
<meta property="og:type" content="website">
<meta property="og:title" content="hello shaokun">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="hello shaokun">
<meta property="og:description" content="记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同探讨">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hello shaokun">
<meta name="twitter:description" content="记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同探讨">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/">





  <title>hello shaokun</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hello shaokun</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">code is law</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/09/eos dapp开发 官方教程学习6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/09/eos dapp开发 官方教程学习6/" itemprop="url">eos dapp开发学习 第四课 续</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-09T21:48:45+08:00">
                2018-11-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><blockquote>
<p>很幸运，总算把新版本的eos和cdt装上了，踩过了很多坑，说多了都是泪。 </p>
<ul>
<li>首先，目前本地我的环境eos1.4 eosio.cdt1.3.2 所以你按照接下来的教程走，那么请核对你的版本</li>
<li>坑1 ==&gt; 如果在原来的账号上部署过类似的table的合约，再次更新合约如果在table中增加修改了字段，能够部署，但是不能够得到得到table的内容和执行action，建议用新的账号进行部署解决</li>
<li>坑2 ==&gt; <a href="https://developers.eos.io/eosio-home/docs/your-first-contract" target="_blank" rel="noopener">helloworld</a>很流畅，一路走下去完美。<a href="https://developers.eos.io/eosio-home/docs/data-persistence" target="_blank" rel="noopener">table数据储存</a>这里不知道知道是我的操作不对还是怎么回事，跟着官网的教程，abi和wasm都能够正常生成，这里合约能够部署上去。但是来了，无法get table，也无法push action。</li>
<li>坑3 ==&gt; 语法变了哈，这里强调一下，支持vector，enume，map 和任何自定义的类型哈，剩下的这个就大家自行琢磨了</li>
<li>坑4 ==&gt; 目前来看，尽量把合code在一个cpp中，不然有想不到的意外等着的哈</li>
</ul>
</blockquote>
<h4 id="合约代码"><a href="#合约代码" class="headerlink" title="合约代码"></a>合约代码</h4><p><code>cardgame.hpp</code></p>
<pre><code>#pragma once
#include &lt;eosiolib/eosio.hpp&gt;
using namespace std;

class [[eosio::contract]]cardgame : public eosio::contract {
  public:
    cardgame(eosio::name reciever,eosio::name code,eosio::datastream&lt;const char*&gt; ds )
                                :contract(reciever,code,ds),
                                _users(reciever,code.value),
                                _seed(reciever,code.value){};

    [[eosio::action]] void login(eosio::name user);
    [[eosio::action]] void startgame(eosio::name user);
    [[eosio::action]] void playcard(eosio::name user,uint8_t player_card_index);

  private:
    enum game_status:int8_t
    {
      ONGOING = 0,      // 游戏正在进行中
      PLAYER_WON = 1,   // 游戏已经结束，玩家获得胜利
      PLAYER_LOST = -1 // 游戏结束， 完结失败
    };
    enum card_type : uint8_t  // 卡片的类型 总共五种属性类型,总共17张卡牌
    {
      EMPTY = 0,    // 不存在的卡片
      FIRE = 1,     // 火属性， 克木  攻击力为 1 和 2 的各两张  攻击力为3的一张    总共5张
      WOOD = 2,     // 木属性， 克水  攻击力为 1 和 2 的各两张  攻击力为3的一张    总共5张
      WATER = 3,    // 水属性   克火  攻击力为 1 和 2 的各两张  攻击力为3的一张    总共5张
      NEUTRAL = 4,  // 中立属性       攻击力为3 总共1张 
      VOID = 5      // 平局属性       共计力为0 总共1张
    };

    struct card
    {
      uint8_t type;   // 卡片类型
      uint8_t attack_point; // 卡片的攻击力
    };

    const  map&lt;uint8_t,card&gt; card_dict = {
        {0 , {EMPTY , 0}},
        {1 , {EMPTY , 1}},
        {2 , {EMPTY , 1}},
        {3 , {EMPTY , 2}},
        {4 , {EMPTY , 2}},
        {5 , {EMPTY , 3}},
        {6 , {EMPTY , 1}},
        {7 , {EMPTY , 1}},
        {8 , {EMPTY , 2}},
        {9 , {EMPTY , 2}},
        {10 , {EMPTY , 3}},
        {11 , {EMPTY , 1}},
        {12 , {EMPTY , 1}},
        {13 , {EMPTY , 2}},
        {14 , {EMPTY , 2}},
        {15 , {EMPTY , 3}},
        {16 , {EMPTY , 3}},
        {17 , {EMPTY , 0}},
    };
    struct game
    {
     int8_t status = ONGOING;   // 只要登录 默认游戏正在进行
     int8_t life_player = 5;    // 游戏玩家 5条生命
     int8_t ai_player = 5;      // 游戏玩家 5条生命
     vector&lt;uint8_t&gt;  deck_player = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17}; // 玩家待选的卡牌id
     vector&lt;uint8_t&gt; deck_ai = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17};     // ai待选的卡牌id
     vector&lt;uint8_t&gt; hand_player = {0,0,0,0}; // 玩家的手里牌
     vector&lt;uint8_t&gt; hand_ai = {0,0,0,0};     // ai的手里牌
     uint8_t selected_card_player = 0;          // 从待选牌中选中的牌
     uint8_t selected_card_ai = 0;              // 从待选牌中选中的牌
    };


      struct [[eosio::table]] userinfo
      {
          eosio::name  name;            
          uint16_t win_count = 0;        
          uint16_t lost_count = 0;
      game game_data;         

          auto primary_key() const {return name.value;}  
      };

    struct [[eosio::table]] seed 
    {
      uint64_t key = 1;
      uint32_t seed_value = 1;

      auto primary_key() const {return key;};
    };

      typedef eosio::multi_index&lt;&quot;userinfo&quot;_n,userinfo&gt; user_index;
    typedef eosio::multi_index&lt;&quot;seed&quot;_n,seed&gt; seed_index;
    user_index _users; //声明表的实例
    seed_index _seed;

  int random(const int range);
  void draw_card(vector&lt;uint8_t&gt;&amp; deck, vector&lt;uint8_t&gt;&amp; hand);
};
</code></pre><p><code>cardgame.cpp</code></p>
<pre><code>#include &quot;cardgame.hpp&quot;

void cardgame::login(eosio::name user)
{
    _users.emplace(get_self(),[&amp;](auto&amp;  u){
            u.name = user;
    });
}

void cardgame::startgame(eosio::name user) {
    auto&amp; itr = _users.get(user.value,&quot;User not exist&quot;);
    _users.modify(itr,get_self(),[&amp;](auto&amp; _to_modify_user){
        game game_data;
        for(uint8_t i = 0; i &lt; 4; i++){
            draw_card(game_data.deck_player,game_data.hand_player);
            draw_card(game_data.deck_ai,game_data.hand_ai);
        }
        _to_modify_user.game_data = game_data;
    });
}

void cardgame::playcard(eosio::name user, uint8_t player_card_index){
    eosio::require_auth(user);
    eosio_assert(player_card_index &lt; 4,&quot;invalid hand index&quot;);// 手上牌最多四张
    // 通过user找到数据表中数据
    auto&amp; player = _users.get(user.value,&quot;User not exist&quot;);
    eosio_assert(player.game_data.status == ONGOING,&quot;game have ended&quot;);
    eosio_assert(player.game_data.selected_card_player == 0,&quot;the player have selected car in this turn&quot;);
    // 修改数据表
    _users.modify(player,get_self(),[&amp;](auto&amp; _to_modify_user){
        game&amp; game_data = _to_modify_user.game_data;
        // 设定选中的卡片id
        game_data.selected_card_player = game_data.hand_player[player_card_index];
        // 将手中卡片对应位置置位empty
        game_data.hand_player[player_card_index] = 0;
    });
};
int cardgame::random(const int range) {
    auto seed_itr = _seed.begin();
    if (seed_itr  == _seed.end()){    // 如果没有随机数据，就用默认值初始化
        seed_itr = _seed.emplace(get_self(),[&amp;](auto&amp; s){
            s = seed{};
        });
    };
    int prime = 65535;
    int new_seed_value = (seed_itr-&gt;seed_value + now()) % prime;
    _seed.modify(seed_itr,get_self(),[&amp;](auto&amp; s){
            s.seed_value = new_seed_value;
    });
    // 随机范围  0 ~ range
    int random_res = new_seed_value % range;
    return random_res;
};
void cardgame::draw_card(vector&lt;uint8_t&gt;&amp; deck, vector&lt;uint8_t&gt;&amp; hand) {
      int deck_card_idx = random(deck.size());
      int first_empty_slot = -1;
      for (int i = 0; i &lt;= hand.size(); i++) {
          auto id = hand[i];
          if (card_dict.at(id).type == EMPTY) {
              first_empty_slot = i;
              break;
          }
        }
      eosio_assert(first_empty_slot != -1, &quot;No empty slot in the player&apos;s hand&quot;);
      hand[first_empty_slot] = deck[deck_card_idx];
      deck.erase(deck.begin() + deck_card_idx);
 };
EOSIO_DISPATCH(cardgame,(login)(startgame)(playcard))
</code></pre><ul>
<li>由于上面的坑，用shaokun11113是无法正确的，所以我用了shaokun11114进行部署  </li>
<li>终于能够写数据到链上了<img src="/img_eos1/eos11.png" alt="eos">   </li>
<li><a href="https://github.com/shaokun11/eoslearning/tree/eos-dve4-update" target="_blank" rel="noopener">更新的合约源码</a>，这次就没有更新前端的mock数据了，相信聪明的你一定知道怎样调整过来</li>
</ul>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#x73;&#x6b;&#x75;&#x6e;&#x6e;&#121;&#64;&#49;&#54;&#x33;&#46;&#99;&#111;&#109;" target="_blank" rel="noopener">&#x73;&#x6b;&#x75;&#x6e;&#x6e;&#121;&#64;&#49;&#54;&#x33;&#46;&#99;&#111;&#109;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/02/eos dapp开发 官方教程学习5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/02/eos dapp开发 官方教程学习5/" itemprop="url">eos dapp开发学习 第四课</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-02T21:02:05+08:00">
                2018-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><blockquote>
<p>官方又发布新版本了，目前写的合约也部署不上了，新版本的语法变了确实蛮多的，目前仅按照官网的教程把流程过一遍了<br>很幸运，目前的官方的游戏第一次和第二次已经被我玩了，这里也把第二次的游戏流程分享给大家，对于接下来编写代码心里有点底，因为本课主要是智能合约的编写。<br>Elemental Battles是一款单人纸牌游戏，其中包括元素之间的战斗。对手将通过在EOSIO上运行的智能合约来代表。<br><img src="/img_eos1/eos_react5.gif" alt="eos"></p>
</blockquote>
<h4 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h4><blockquote>
<p>在本课中，我们将准备我们的游戏。我们还将在智能合约中构建startgame和playcard动作，并从前端触发。在本课程结束时，您将能够开始玩元素战斗并迈出第一步！  </p>
</blockquote>
<h4 id="合约编写"><a href="#合约编写" class="headerlink" title="合约编写"></a>合约编写</h4><blockquote>
<p>这里我暂时无法部署上去，只能先把代码放在这里了。看了上面的游戏玩法，各位同学结合注释应该看得明白了。<br>玩家和ai进行卡片游戏对战，都从各自的待选17张牌中选出四张，每张牌有不同的攻击力。根据攻击力进行判断一次对决的胜负，各有5条命，输一次减少一条命，谁先到达0谁就输了。游戏简单，主要是了解一下智能合约的开发流程<br>这里并没有成功布置到链上，以后补上了<br><a href="https://github.com/shaokun11/eoslearning/tree/eos-dev4" target="_blank" rel="noopener">第四课源码</a></p>
</blockquote>
<p><code>cardgame.hpp</code></p>
<pre><code>#include &lt;eosiolib/eosio.hpp&gt;
using namespace std;
class cardgame : public eosio::contract {
// 继承contract
  public:
    //构造方法,并实例化了multi_index表users
    cardgame( account_name self):contract(self),
                                _users(self,self),
                                _seed(self,self){};

    // table和action 必须加上@abi 的注解，这样才能生存对应的abi，
    // 在eosio.cdt中，使用 [[eosio::action]] 更加简洁 
    [[eosio::action]]
    void login(account_name user);

    // 开始游戏，分发手里牌
    [[eosio::action]]
    void startgame(account_name user);

    //从手上牌选择卡片进行对战
    [[eosio::action]]
    void playcard(account_name user,uint8_t player_card_index);

  private:
    enum game_status:int8_t
    {
      ONGOING = 0,      // 游戏正在进行中
      PLAYER_WON = 1,   // 游戏已经结束，玩家获得胜利
      PLAYER_LOST = -1 // 游戏结束， 完结失败
    };
    enum card_type : uint8_t  // 卡片的类型 总共五种属性类型,总共17张卡牌
    {
      EMPTY = 0,    // 不存在的卡片
      FIRE = 1,     // 火属性， 克木  攻击力为 1 和 2 的各两张  攻击力为3的一张    总共5张
      WOOD = 2,     // 木属性， 克水  攻击力为 1 和 2 的各两张  攻击力为3的一张    总共5张
      WATER = 3,    // 水属性   克火  攻击力为 1 和 2 的各两张  攻击力为3的一张    总共5张
      NEUTRAL = 4,  // 中立属性       攻击力为3 总共1张 
      VOID = 5      // 平局属性       共计力为0 总共1张
    };
    struct card
    {
      uint8_t type;   // 卡片类型
      uint8_t attack_point; // 卡片的攻击力
    };
    typedef uint8_t card_id;
    const map&lt;card_id,card&gt; card_dict = {
        {0 , {EMPTY , 0}},
        {1 , {EMPTY , 1}},
        {2 , {EMPTY , 1}},
        {3 , {EMPTY , 2}},
        {4 , {EMPTY , 2}},
        {5 , {EMPTY , 3}},
        {6 , {EMPTY , 1}},
        {7 , {EMPTY , 1}},
        {8 , {EMPTY , 2}},
        {9 , {EMPTY , 2}},
        {10 , {EMPTY , 3}},
        {11 , {EMPTY , 1}},
        {12 , {EMPTY , 1}},
        {13 , {EMPTY , 2}},
        {14 , {EMPTY , 2}},
        {15 , {EMPTY , 3}},
        {16 , {EMPTY , 3}},
        {17 , {EMPTY , 0}},
    };
    struct game
    {
     int8_t status = ONGOING;   // 只要登录 默认游戏正在进行
     int8_t life_player = 5;    // 游戏玩家 5条生命
     int8_t ai_player = 5;      // 游戏玩家 5条生命
     vector&lt;card_id&gt;  deck_player = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17}; // 玩家待选的卡牌id
     vector&lt;card_id&gt; deck_ai = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17};     // ai待选的卡牌id
     vector&lt;card_id&gt; hand_player = {0,0,0,0}; // 玩家的手里牌
     vector&lt;card_id&gt; hand_ai = {0,0,0,0};     // ai的手里牌
     card_id selected_card_player = 0;          // 从待选牌中选中的牌
     card_id selected_card_ai = 0;              // 从待选牌中选中的牌
    };

      [[eosio::table]]
      struct userinfo
      {
          account_name name;            //玩家的名字    account_name 是uint64_t的一个别名
          uint16_t win_count = 0;        
          uint16_t lost_count = 0;
      game game_data;         // game 

          auto primary_key() const {return name;}  
          //多索引表查找名为primary_key（）的getter函数。这必须使用结构中的第一个字段，编译器将使用它来添加主键。让我们定义这个功能。
      };
    [[eosio::table]]
    struct seed // 这个是用来生成随机数的，全局储存，只要有人玩就会改变，没办法，eos里只能用table来持久化数据在链上
    {
      uint64_t key = 1;
      uint32_t value = 1;

      auto primary_key(){return key;};
    }

      typedef eosio::multi_index&lt;N(userinfo),userinfo&gt; user_index;
      //多索引表定义，它有两个参数： 表名 
      //                         结构定义了我们打算在多索引表中存储的数据。 
      // 新类型名称作为我们的多索引表定义的别名
      // 
      // 多索引表中的数据由四条信息标识： code（account_name） 
      //                              scop 
      //                              table name
      //                              primary key 
    typedef multi_index&lt;N(seed),seed&gt; seed_index;
    user_index _users; //声明表的实例
    seed_index _seed;

    int random(const int range);
    void draw_one_card(vector&lt;uint8_t&gt;&amp; deck,vector&lt;uint8_t&gt;&amp; hand);
};    
</code></pre><p><code>cardgame.cpp</code> </p>
<pre><code>#include &quot;cardgame.hpp&quot;
void cardgame::login(account_name user)
{
    require_auth(user); 
    //确保这个用户已经被授权
    // 这里我理解了很久，把我的想法记录在这里
    // 这里是调用此合约的account name，即提供私钥的account，这里传入的这个account必须拥有它的active权限，
    // 当然，这里还可以要求有其他的权限，这样就可以给特殊的账号特殊的权限
    auto user_iterator = _users.find(user);  // 查找
    if (user_iterator == _users.end()) {
        user_iterator = _users.emplace(user, [&amp;](auto&amp; new_user){
            new_user.name = user;
        });
    }
    // 这里使用multi_index的find 和 emplace(插入)两种方法，
    // 这些方法的形式都是一样的，记住就好，可以去官网查看详细的方法说明
}

void cardgame::startgame(account_name name) {
    require_auth(name);
    auto&amp; info = _users.get(name, &quot;user not exist&quot;);
    _users.modify(info,name,[&amp;](auto&amp; _to_modify_user){
        game game_data;
        for(uint8_t i = 0; i &lt; 4; i++){
            draw_one_card(game_data.deck_player,game_data.hand_player);
            draw_one_card(game_data.deck_ai,game_data.hand_ai);
        }
        _to_modify_user.game_data = game_data;
    });
}

void cardgame::playcard(account_name user,uint8_t player_card_index){
    require_auth(user);
    eosio.assert(player_card_index &lt; 4,&quot;invalid hand index&quot;); // 手上牌最多四张
    // 通过user找到数据表中数据
    auto&amp; player = _users.get(user,&quot;User not exist&quot;);
    eosio_assert(player.game_data.status == ONGONING,&quot;game have ended&quot;); // 确保本轮游戏没有结束
    eosio_assert(player.game_data.selected_card_player == 0,&quot;the player have selected car in this turn&quot;); // 确保手上没有选牌
    // 修改数据表
    _users.modify(player,user,[&amp;](auto&amp; _to_modify_user){
        game&amp; game_data = _to_modify_user.game_data;
        // 设定选中的卡片id
        game_data.selected_card_player = game_data.hand_player[player_card_index];
        // 将手中卡片对应位置置位empty
        game_data.hand_player[player_card_index] = 0;
    });
}
EOSIO_ABI(cardgame,(login)(playcard))
</code></pre><p><code>gameplay.cpp</code></p>
<pre><code>#include &quot;cardgame.hpp&quot;
int cardgame::random(const int range) {
    auto seed_itr = _seed.begin();
    if (seed_itr  == _seed.end())
    {    // 如果没有随机数据，就用默认值初始化
        seed_itr = _seed.emplace(_self,[&amp;](auto&amp; seed){})
    };
    int prime = 65535;
    // 新值得范围 0 ~ 65535
    auto new_seed_value = (seed_itr.value + now()) % prime;
    _seed.modify(seed_itr,_self,[&amp;](auto&amp; s){
            s.value = new_seed_value;
    });
    // 随机范围  0 ~ range
    int random_res = new_seed_value % range;
    return random_res;
}
// 根据待选卡片和手上已有的卡片，随机进行选择新的卡片
void cardgame::draw_one_card(vector&lt;uint8_t&gt; &amp;deck,vector&lt;uint8_t&gt; &amp;hand){
    // 0 ~ 16
     int deck_card_index = random(deck.size());
     int first_emprty_slot = -1;
     for (int i = 0; i &lt; hand.size; ++i)
     {    
         auto id = hand[i];
         if (card_dict.at(id).type == EMPTY){
             first_emprty_slot = i;
             break;
         }
     }
     eosio_assert(first_emprty_slot !=- 1, &quot;No empty slot in the players hand&quot;);
     // 如果手上的牌 有空位，进行随机赋值
     hand[first_emprty_slot] = deck[deck_card_index];
     // 待选牌中移除掉已经被赋值给手上的牌
     deck.erase(deck.began() + deck_card_index);
 }
</code></pre><h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#x73;&#x6b;&#117;&#x6e;&#x6e;&#121;&#64;&#49;&#54;&#51;&#46;&#99;&#111;&#109;" target="_blank" rel="noopener">&#x73;&#x6b;&#117;&#x6e;&#x6e;&#121;&#64;&#49;&#54;&#51;&#46;&#99;&#111;&#109;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/27/eos dapp开发 官方教程学习4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/27/eos dapp开发 官方教程学习4/" itemprop="url">eos dapp开发学习 第三课</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-27T13:12:11+08:00">
                2018-10-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><blockquote>
<p>上一篇文章登录的时候，你如果做了，虽然也未报错，按照结论貌似登录上了，但是，其实是没有登录上的，这里给大家说一声对不起，因为其中的某些参数未完全按照官方的例子敲，所以造成了参数不对。<br>既然上篇文章登录错了，那么这篇文章还是得纠正过来，并且找到错在哪里</p>
</blockquote>
<h4 id="教程内容"><a href="#教程内容" class="headerlink" title="教程内容"></a>教程内容</h4><blockquote>
<p>在本课中，我们将学习如何从区块链中获取数据。数据通过来自前端的交易进入区块链，我们在第2.2课和第2.3课中查看了这一点。调用操作可以更改状态，该状态存储在多索引表中。此外，此操作记录在区块链中。</p>
</blockquote>
<h4 id="教程结果"><a href="#教程结果" class="headerlink" title="教程结果"></a>教程结果</h4><blockquote>
<p>首先声明，所有的结果均未完全百分之百按照官方教程走，省略了其中的ui，而只涉及了其中正常开发所必须掌握的内容，如果觉得页面不够美丽，建议你可以按照官方的例子去学，这是地址<a href="https://battles.eos.io/" target="_blank" rel="noopener">elemental battles</a><br>本次调整了部分逻辑，方便我操作，如果你觉得不合适，可以修改<br>再来强调一下你需要哪些知识才能看懂：</p>
<blockquote>
<ul>
<li>区块链共识算法，这是区块链的核心</li>
<li>eos 账户,权限，cpu,net,ram等相关知识</li>
<li>eos 本地环境，得安装在电脑上，安装方式自行查找（也就是部署合约用，如果你没有而又想走捷径，这里有个好东西，拿去不谢，<a href="https://github.com/itleaks/js4eos" target="_blank" rel="noopener">eos4js</a>，这个库开源出来才2天，也许后面还有更多类似的优秀的库，你都可以使用）</li>
<li>eoscdt 得安装，去下载，然后下一步就好。（这个东西是用来编译成wasm和abi的，单独抽出来的，建议使用，当前时间我使用的eoscdt1.2，语法是旧的，如果你后续用了高版本，按照这篇文章敲语法会有问题的，但是思想是不变的）</li>
<li>react 这是一个前端的库，为什么要用这个？因为第一，我会，第二，官方也是用的他，第三，用起来很爽，你如果用的别的如vue活着原生来写，只要你把流程搞懂了，也是一样的</li>
<li>react-redux 这东西有点难懂，可能会看得你一脸蒙蔽，和上面一点是配套使用的，数据流的管理方式。简单理解就是数据的传递方式，写起来很复杂，理解起来还是很烧脑。我一时半会也说不完，来这里去看看吧<a href="https://cn.redux.js.org/docs/react-redux/" target="_blank" rel="noopener">react-redux</a>。（我也考虑过不用这个写，这样简单很多，对大家的理解也会有帮助，但是考虑到官方用了，我也就顺便用了） </li>
<li>c++ 这个东西我也是为了写eos智能合约才开始学的，还好我之前有java的基础，学点基础够我们用了，难点的在它的指针上面，（话说，写合约貌似不怎么用指针了，eos已经帮我们封装的够多了，用得多的是引用），这个就看自己了  </li>
<li>node 基础 够用就好  </li>
<li>当然 js基础  同样够用就好</li>
<li>梯子</li>
<li>系统，反正不能是Windows系统</li>
</ul>
</blockquote>
</blockquote>
<p>为了避免上一篇文章犯错，这次先把结果展示了<br><a href="https://github.com/shaokun11/eoslearning/tree/eos-dev03" target="_blank" rel="noopener">eos第三课源码</a></p>
<blockquote>
<p>这里尽量放git图片了，先看图后看文字解释。  </p>
</blockquote>
<p><img src="/img_eos1/eos_react4.gif" alt="eos"> </p>
<h4 id="布局更新"><a href="#布局更新" class="headerlink" title="布局更新"></a>布局更新</h4><ul>
<li>更改了采取内置账号和秘钥的方式，直接点击不用输入了</li>
<li>当登录成功，去区块链上拿到用户的信息，刷新ui</li>
<li><p>下面的代码已经有注释了</p>
<pre><code>import {Api, JsonRpc, JsSignatureProvider} from &apos;eosjs&apos;;

async function takeAction(action, account, pk, dataValue) {
    console.log(&quot;takeAction&quot;, action, dataValue)
    const rpc = new JsonRpc(process.env.REACT_APP_EOS_HTTP_ENDPOINT);
    const signatureProvider = new JsSignatureProvider([pk]);
    const api = new Api({rpc, signatureProvider, textDecoder: new TextDecoder(), textEncoder: new TextEncoder()});
    try {
        return await api.transact({
            actions: [{
                account: &quot;shaokun11113&quot;,  // 合约的拥有者
                name: action,             // 执行的合约方法
                authorization: [{
                    actor: account,       // 执行合约的账户
                    permission: &apos;active&apos;, // 执行合约的账户所需要的权限
                }],
                data: dataValue,          // 所需要的参数,以json字符串进行传递，注意key为合约中定义的参数的名字，也可以通过abi进行查看

        }]
    }, {
        blocksBehind: 3,              // 多少个块后确认
        expireSeconds: 30,            // 超时时间
    });
} catch (err) {
    throw(err)
}
}

class ApiService {

static async getUserByName(username) {
    const rpc = new JsonRpc(process.env.REACT_APP_EOS_HTTP_ENDPOINT);
    const res = await rpc.get_table_rows({
        code: process.env.REACT_APP_EOS_CONTRACT_NAME,             //由于在合约中写死了，这里也可以写死
        scope: process.env.REACT_APP_EOS_CONTRACT_NAME,             //由于在合约中写死了，这里也可以写死
        table: &quot;userinfo&quot;,                                           //由于在合约中写死了，这里也可以写死
        json: true,                                                // 默认值 ，可以不填
        lower_bound: username,                                      // 匹配规则，不填默认返回全部
    })
    return res.rows[0];
}

static login({name, key}) {
    return new Promise((resolve, reject) =&gt; {
        takeAction(&quot;login&quot;, name, key, {user: name}).then(res =&gt; {
            // 执行成功会返回默认的交易hash
            console.log(&quot;login success&quot;, res);
            resolve();
        }).catch(err =&gt; {
            console.log(err)
            reject(err);
        })
    });
}
}

export default ApiService;
</code></pre></li>
<li><p>当登录成功显示的组件,这是当跳转后立即获取最新数据。结合上面的代码，就知道了。</p>
<p>  <img src="/img_eos1/eos10.png" alt="eos"> </p>
</li>
<li><p>上面最后，我使用postman拿取了合约中所有的数据，可以看到，目前的数据储存是两条，当然，你在代码中也可以实现，至于怎么实现，我想你应该知道的。至于上一篇文章错在哪里，你仔细看了上面的代码就知道了。</p>
</li>
</ul>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<h4 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h4><blockquote>
<p>对个人的总结：<br>目前分享的经验不是很足，严格算起来，就一个多月而已,还是经过一个外国老哥的建议才开始写的，目前文章也比较粗糙。<br>但我还是会尽力来记录这些。一来这样记录下来可以让自己对知识把握得更牢靠，二来也可以帮助到他人。<br>从零开始搭博客，学习markdown语法，搜集图片，上传图片，传动图或者视频，都是一步一步摸索出来，中间坑很多，但是乐趣也在此.</p>
</blockquote>
<p>至于后续的文章，尽量跟着官方的教程走，所以到这里，第三课结束了。<br>小小的总结一下前三课的内容    </p>
<ul>
<li>第一课  搭环境  </li>
<li>第二课  搭ui与合约的编写</li>
<li>第二课续 部署，测试合约（合约部署成功，连接合约是失败的）</li>
<li>第三课  更改上课的错误，连接合约，增加新的展示界面</li>
</ul>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#x73;&#x6b;&#x75;&#110;&#110;&#121;&#64;&#x31;&#x36;&#x33;&#46;&#x63;&#x6f;&#109;" target="_blank" rel="noopener">&#x73;&#x6b;&#x75;&#110;&#110;&#121;&#64;&#x31;&#x36;&#x33;&#46;&#x63;&#x6f;&#109;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/21/eos dapp开发 官方教程学习3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/21/eos dapp开发 官方教程学习3/" itemprop="url">eos dapp开发学习 第二课 续</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-21T13:16:25+08:00">
                2018-10-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><blockquote>
<p>到此我这里发现了多个问题，这里列出来，希望帮到遇到同样问题的同学</p>
<ol>
<li>目前eoscdt git已经更新到1.4版本了，其中的结构，语法更改了很多，我这边mac系统是10.12.6，弄了一周还是没办法升级到13，而新的cdt最低需求已经要13了，忧伤。。。<br>而我从源码编译，总是clone不下来，试过各种方法均失败了。这里提醒一下，最好按照他的系统要求去安装，已经有打包好的二进制文件了 </li>
<li>目前的官网的版本使用的eoscdt1.2，而经过上面的方式失败了，我再次尝试了这个，成功了</li>
<li>这里如果按照昨天的cpp文件使用eosio-cpp进行编译，是没有问题的。但是无法部署合约，这里需要将table name 由user_info 改为 userinfo   注意 不能改成userInfo,UserInfo等等，即所有的需要写入abi的action和table name必须 仅能包含<br><code>.12345abcdefghijklmnopqrstuvwxyz</code><br>这些字符</li>
<li>莫名的感觉忧伤而兴奋，忧伤是跟不上新版本的步伐，兴奋的是开发越来越规范，现在可以接着上一篇文章继续写作了</li>
<li>带着梯子办事，总会减少很多很多没有必要的问题</li>
</ol>
</blockquote>
<h4 id="编译、部署合约"><a href="#编译、部署合约" class="headerlink" title="编译、部署合约"></a>编译、部署合约</h4><blockquote>
<p>不同的版本有着不同的变化，这里仅以eoscdt1.2进行操作，如果后续使用eoscdt1.3或者使用之前的eosiocpp来编译出来的abi和wasm文件肯定是用不了的</p>
</blockquote>
<ul>
<li><p>更改cardgame.hpp<br><img src="/img_eos1/eos8.png" alt="contract">  </p>
<pre><code>///@abi action  =&gt; [[eosio::action]]
///@abi table =&gt; [[eosio::table]]
user_info =&gt; userinfo
</code></pre></li>
<li><p>再次生成abi和wasm文件，这里要切换到c++文件所在的目录</p>
<pre><code>eosio-cpp -o cardgame.wasm cardgame.cpp --abigen
</code></pre></li>
<li><p>部署合约，这里在任何目录执行都可以，合约的目录输入绝对路径</p>
<pre><code>cleos -u http://jungle.cryptolions.io:18888 set contract shaokun11113 /Users/shaokun/Desktop/eoslearning/cardgame -p shaokun11113@active
</code></pre></li>
<li><p>当部署遇到图中红色的提示时，请注意table,action,class，struct的名字所含字符<br><img src="/img_eos1/eos9.png" alt="contract"><br>由之前的结论可以看到，我们合约成功部署了</p>
</li>
</ul>
<h4 id="与前端共同交互合约"><a href="#与前端共同交互合约" class="headerlink" title="与前端共同交互合约"></a>与前端共同交互合约</h4><ul>
<li><p>这里使用了最新的eosjs,请更新 <a href="https://github.com/EOSIO/eosjs" target="_blank" rel="noopener">eosjs</a></p>
<pre><code>npm install eosjs@beta    
</code></pre></li>
<li><p>更新后package.json ,请注意eosjs的版本</p>
<pre><code>{
  &quot;dependencies&quot;: {
    &quot;eosjs&quot;: &quot;^20.0.0-beta2&quot;,
    &quot;react&quot;: &quot;^16.5.2&quot;,
    &quot;react-dom&quot;: &quot;^16.5.2&quot;,
    &quot;react-redux&quot;: &quot;^5.0.7&quot;,
    &quot;react-scripts&quot;: &quot;2.0.5&quot;,
    &quot;redux&quot;: &quot;^4.0.1&quot;,
    &quot;redux-logger&quot;: &quot;^3.0.6&quot;
  },
}
</code></pre></li>
<li><p>新版的eosjs的引入有更改，请仔细对比</p>
</li>
<li>由于此处的合约只要是合法的注册到jungle上的account 都可以登录，所以前端框的private key的输入框可以随意输入，这里请注意风险 </li>
<li>登录成功后，跳转界面！！！本篇文章的代码<a href="https://github.com/shaokun11/eoslearning/tree/eos-dev02-update" target="_blank" rel="noopener">lesson2 code</a><br><img src="/img_eos1/eos_react3.gif" alt="contract">  </li>
</ul>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<h4 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h4><blockquote>
<p>总算完成了之前的坑。^o^<br>中间有很多前端的知识，这不是这个课程讲解的重点，只能靠各位同学自己去补习了。这个系列使用react，redux也是一个很庞大的工程，所以可以简单一点，展示一下交互就好。<br>应该说到此，区块链与前端的交互已经完成，接下来就是充实智能合约的功能了。如果你做到了这一步，建议去<a href="https://developers.eos.io/eosio-cpp/reference" target="_blank" rel="noopener">eos c++ api</a>这里了解一下api，这样对于后面的合约编写会有一个更深层次的掌握</p>
</blockquote>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#115;&#x6b;&#x75;&#x6e;&#110;&#x79;&#x40;&#49;&#54;&#x33;&#x2e;&#x63;&#x6f;&#x6d;" target="_blank" rel="noopener">&#115;&#x6b;&#x75;&#x6e;&#110;&#x79;&#x40;&#49;&#54;&#x33;&#x2e;&#x63;&#x6f;&#x6d;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/20/eos dapp开发 官方教程学习2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/20/eos dapp开发 官方教程学习2/" itemprop="url">eos dapp开发学习 第二课</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-20T22:11:25+08:00">
                2018-10-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h5><blockquote>
<p>我们将学习如何在智能合约中存储玩家信息;使用登录操作。然后我们将开始构建Web前端，添加Login页面。 要使登录页面与智能合约交互，我们将使用eosjs连接到EOSIO区块链。我们使用eosjs库来调用智能合约中的登录操作。接下来，我们将React连接到Redux以存储应用程序状态。最后，我们将所有这些结合起来并添加一个游戏页面，以便我们有一个工作登录屏幕。 在本课程结束时，玩家应该能够登录游戏并进入游戏中的第一个屏幕。</p>
</blockquote>
<h4 id="step-1-定义表结构"><a href="#step-1-定义表结构" class="headerlink" title="step 1 定义表结构"></a>step 1 定义表结构</h4><p>对于元素战斗，我们需要存储每个玩家的游戏进度的详细信息或状态。为此，我们将使用多索引表，这是EOSIO的一个功能。您可以将多索引表视为内存数据库。要使用多索引表，我们需要告诉EOSIO我们要在其中存储哪些数据。 对于游戏，我们需要存储玩家信息，所以让我们在之前创建的cardgame.hpp中创建一个名为user_info的结构。我们要存储：</p>
<ul>
<li>the player’s name</li>
<li>win count (default to 0)</li>
<li><p>lost count (default to 0)</p>
</li>
<li><p>cardgame.hpp（这里传图片得了，看得仔细一点）<br><img src="/img_eos1/eos5.png" alt="lessons"></p>
</li>
</ul>
<h4 id="step-2-写入数据到多索引表-user中"><a href="#step-2-写入数据到多索引表-user中" class="headerlink" title="step 2 写入数据到多索引表_user中"></a>step 2 写入数据到多索引表_user中</h4><blockquote>
<p>现在我们可以使用我们的多索引表了。所以让我们存储我们的合同状态。为此，我们将创建第一个操作，即登录操作。</p>
</blockquote>
<p><img src="/img_eos1/eos6.png" alt="lessons"></p>
<h4 id="step-3-前端页面组件布局"><a href="#step-3-前端页面组件布局" class="headerlink" title="step 3 前端页面组件布局"></a>step 3 前端页面组件布局</h4><blockquote>
<p>这里还是使用Jungle test net来做，account shaokun11113。<br>我这里出现了一个问题，就是之前我把eos升级了，但是我的电脑没有升级升级到eoscdt。导致现在能够生成abi和wasm文件，但是部署不到链上去，出现的是如下错误，哪位同学知道可以告诉我，感谢。<br><img src="/img_eos1/eos7.png" alt="lessons"></p>
</blockquote>
<p>这里卡住我太久了，那部署合约这一步就先跳过，这一篇文章我们先根据官方的步骤先把前端页面展示出来吧！<br><img src="/img_eos1/eos_react.gif" alt="lessons"><br>主要是精简了官方的图片和ui，这一部分先把功能实现，有心思的同学如果觉得我的这个丑就按照官方的来吧，这里用到了几个react的库，建议你们先了解一下</p>
<pre><code> &quot;eosjs&quot;: &quot;^16.0.9&quot;,   
&quot;react&quot;: &quot;^16.5.2&quot;,
&quot;react-dom&quot;: &quot;^16.5.2&quot;,
&quot;react-redux&quot;: &quot;^5.0.7&quot;,
&quot;react-scripts&quot;: &quot;2.0.5&quot;,
&quot;redux&quot;: &quot;^4.0.1&quot;,
&quot;redux-logger&quot;: &quot;^3.0.6&quot;
</code></pre><h4 id="step-4-页面交互"><a href="#step-4-页面交互" class="headerlink" title="step 4 页面交互"></a>step 4 页面交互</h4><p>由于合约没有部署上，所以没有办法上链进行演示，故此处仅仅是将整个前端的ui交互成功，如果你看过我之前的两篇文章，那么到这里你应该可以理解的。<br><img src="/img_eos1/eos_react2.gif" alt="lessons"></p>
<h4 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h4><p>这篇文章写的很不顺，没有完成最关键的上链一步给大家演示，真是抱歉了。那么只能够走思路了。附上本篇文章所用到的源码 <a href="https://github.com/shaokun11/eoslearning/tree/eos-dev02" target="_blank" rel="noopener">elementel battels dev2</a></p>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#x73;&#107;&#117;&#110;&#x6e;&#121;&#64;&#49;&#x36;&#x33;&#x2e;&#99;&#x6f;&#x6d;" target="_blank" rel="noopener">&#x73;&#107;&#117;&#110;&#x6e;&#121;&#64;&#49;&#x36;&#x33;&#x2e;&#99;&#x6f;&#x6d;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/20/eos dapp开发 官方教程学习1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/20/eos dapp开发 官方教程学习1/" itemprop="url">eos dapp开发学习 第一课</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-20T08:47:47+08:00">
                2018-10-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h5><blockquote>
<p>没想到block one就在10/19放出了一个官方的教程，教程内容很详细，比我上周的详细很多呢，包括语法，逻辑，代码的封装。那么接下来当然也要跟着一步一步的来学一下。<br><a href="https://battles.eos.io" target="_blank" rel="noopener">elemental battles</a> 我这边貌似不用梯子也能进入的哈。</p>
<blockquote>
<p>这里请注意一点，之前的两篇文章使用的是是使用的当前官网的步骤，使用的eosio.cdt1.2进行wasm和abi的，而现在github是最新的1.3版本，语法变化很多，更加规范。<br>而目前的这个教程使用的最开始的方法，所以为了一致，也会使用最古老的方式进行学习，保持统一。综合来看，整体开发dapp的流程和思想是一致的，新版本的只是语法有变化。<br>即整篇采用eos1.2的这个文档 <a href="https://developers.eos.io/eosio-cpp/v1.2.0/docs" target="_blank" rel="noopener">eosio1.2</a><br><img src="/img_eos1/eos1.png" alt="elemental battles cover"><br><img src="/img_eos1/eos0.png" alt="elemental battles cover"><br>为了我自己不糊涂，再啰嗦一遍。建议生产中使用新版本  </p>
</blockquote>
</blockquote>
<ul>
<li>eosio1.2包含了生成.wasm和abi的工具eosiocpp  </li>
<li>eoscdt1.2是单独的一个插件，更加专业，专门用于生成上述两个文件，使用eosio-cpp</li>
<li>eoscdt1.3是1.2的升级版，规范了语法优化了很多</li>
</ul>
<h5 id="准备阶段"><a href="#准备阶段" class="headerlink" title="准备阶段"></a>准备阶段</h5><p><img src="/img_eos1/eos2.png" alt="目录"></p>
<blockquote>
<p>需要自己注册一个账号哈</p>
</blockquote>
<p>可以看到，总共九个大的章节，第0章节介绍了eosio，然后指导安装eosio。这个安装和之前的步骤一样，在此就不啰嗦了。</p>
<h4 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h4><ol>
<li><p>新建三个c++文件,注意命名规则</p>
<pre><code>cardgame.hpp  // 定义智能合约的C ++头文件
cardgame.cpp  // 用于实现智能合约的操作的C++源文件。
gameplay.cpp  // 包含智能合约中使用的内部帮助函数的C++源文件。
</code></pre></li>
</ol>
<p><img src="/img_eos1/eos3.png" alt="文件结构1"></p>
<blockquote>
</blockquote>
<ul>
<li>账户名只能包含字符.abcdefghijklmnopqrstuvwxyz12345。 a-z（小写），1-5和. （英文句点)，必须以字母开头必须为12个字符</li>
<li>表名，结构，函数，类最多只能包含12个字母字符</li>
<li>符号必须是A和Z之间的大写字母字符必须是7个字符或更少</li>
</ul>
<h4 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h4><p>使用create-react-app 创建web项目，并移除其中不需要的文件<br><img src="/img_eos1/eos4.png" alt="文件结构2"></p>
<h4 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h4><p>额，第0课和第一课就到这里结束了，可以看到和我们之前的流程是类似的。同样需要你掌握web和c++的知识，这些知识点都可以通过网络找到，需要自己积累。<br>第0课主要讲解了eosio开发环境的搭建，自备梯子很重要<br>第1课主要讲解的整个项目的结构</p>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#115;&#107;&#117;&#x6e;&#x6e;&#121;&#64;&#x31;&#x36;&#51;&#x2e;&#x63;&#x6f;&#x6d;" target="_blank" rel="noopener">&#115;&#107;&#117;&#x6e;&#x6e;&#121;&#64;&#x31;&#x36;&#51;&#x2e;&#x63;&#x6f;&#x6d;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/14/基于eos连接scatter开发dapp(下)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/14/基于eos连接scatter开发dapp(下)/" itemprop="url">结合scatter学习eos dapp开发，看这篇就够了（下）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-14T09:24:19+08:00">
                2018-10-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="eos智能合约开发-c-合约编写"><a href="#eos智能合约开发-c-合约编写" class="headerlink" title="eos智能合约开发 c++合约编写"></a>eos智能合约开发 c++合约编写</h4><blockquote>
<p>这里需要说明的一下，这个例子和官网提供的hello没有多大的区别,仅仅是带你多了解一下如何编写。其中遇到有些概念难以理解，建议还是参考官网的hello 从头看起</p>
</blockquote>
<pre><code>#include &lt;eosiolib/eosio.hpp&gt;  
#include &lt;eosiolib/print.hpp&gt;
#include&lt;string&gt;

using namespace eosio;
using std::string;

class todolist : public contract {  //继承 contract

  public:
  using contract::contract;           

  todolist(account_name self):contract(self){}   //构造函数
    // account_name 是eoslib中定义的一种类型

  [[eosio::action]]   // 以前的版本使用的 ///abi action ，eoscdt使用这种方式标识，更加的优雅，也就是你要对外开放的方法都加上才会生成在abi中
  void create(account_name author, const uint32_t id, const std::string &amp;description)
  {
  // 记住，这些action方法的返回值只能是void，不然会报错，只有实际做过的人才会知道 ，那你要问我如何读取区块链的内容呢？ 这个问题也困扰了我蛮久，继续看下面
    todo_index todos(_self, _self);
    // 实例化多索引列表，第一个参数是这张表是谁的 code ,即谁有权限去读写它
    // 第二个参数scope，相当于缩小范围去找到这张表
    // _self 是构造函数中的self
    // todo_index 是Multi_index的一个具体的类型，在下面定义的

    todos.emplace(author, [&amp;](auto &amp;new_todo) {
        new_todo.id = id;
        new_todo.description = description;
        new_todo.completed = 0;
    });
    // 使用todos这个表的实例，去添加一条todo
    // 第一个参数表示为这条内容的写入付费的account，第二个参数是一个lambda方法，拿到的参数是这个表中的一行的实例，然后赋值对应的数据即可

    print(&quot;todo#&quot;, id, &quot; created&quot;);
    // 这里，如果你使用命令行方式 执行，执行成功后会打印这个方法，但是如果是dapp开发，这是看不到的，又有一个疑问，那我们怎么知道执行成功了呢？
  }

  [[eosio::action]]
  void complete(account_name author,const uint32_t id)
  {  
  // 更改todo的状态为完成
  todo_index todos(_self, _self);

      auto todo_look = todos.find(id);
      // 是否用find()方法，去查找这条方法对应的实例
      eosio_assert(todo_look != todos.end(), &quot;todo does not exit&quot;);
    // 这里 如果找不到，todos.end() 会返回 null
      todos.modify(todo_look,author,[&amp;](auto &amp;t) {
          t.completed = 1;
      });

      print(&quot;todo #&quot; ,id ,&quot;marked as complted&quot;);
  }

  [[eosio::action]]
  void destroy(account_name author, const uint32_t id)
  {    
        require_auth(author);
        // 权限验证，只能够删除自己的todo

        todo_index todos(_self, author);
      auto todo_look = todos.find(id);
      todos.erase(todo_look);
      print(&quot;todo#&quot;, id, &quot; destroyed&quot;);
  }
  private:
    // 在eoscdt中 注意加上[[eosio::table]] ，否则abi中不会生成这个table
  struct [[eosio::table]] todo {
      uint64_t id;
      string description;
      uint64_t completed;

      uint64_t primary_key() const {
      // 这个方法是必须存在的，上面方法能够查找就是因为这个方法的存在，  
      // 所以说查找只用传入 id即可，  
      // 如果要使用其他的查找方式，得多定义几个查找的方法，最多可以定义16个  
      // 如何定义看官网，这里不演示了  
          return id;
      }

      EOSLIB_SERIALIZE(todo,(id)(description)(completed));
  };

  typedef eosio::multi_index&lt;N(todo),todo&gt; todo_index;
  // 这里定义了多索引列表的具体实现，N(todo)是将你的account 转换为 uint64_t 类型，第二个参数传入表名字， 定义的具体的类型是todo_index

};

EOSIO_ABI(todolist, (create)(complete)(destroy))
</code></pre><h4 id="eos智能合约开发-编译智能合约"><a href="#eos智能合约开发-编译智能合约" class="headerlink" title="eos智能合约开发  编译智能合约"></a>eos智能合约开发  编译智能合约</h4><blockquote>
<p>经过以上的步骤，我们编写好了智能合约，这个合约是一个todolist，可以增加todo,可以将todo变为完成的状态，还可以删除todo,只能删除自己的todo</p>
</blockquote>
<p>这里编译智能合约，需要下载好eoscdt,如果没有下载好，建议完整安装好eoscdt再继续往下走了  </p>
<ol>
<li><img src="/images/contract1.png" alt="contract"><br>新建一个todolist文件夹，将上面写好的todolist.cpp放进去    </li>
<li><p><img src="/images/contract2.png" alt="contract"><br>打开终端，进入文件夹，输入   </p>
<pre><code>eosio-cpp -o todolist.wasm todolist.cpp --abigen
</code></pre></li>
</ol>
<ol start="3">
<li><img src="/images/contract3.png" alt="contract"><br>成功后会在当前文件夹目录下生成 todolist.wasm 和 todolist.abi</li>
</ol>
<h4 id="eos智能合约开发-部署智能合约"><a href="#eos智能合约开发-部署智能合约" class="headerlink" title="eos智能合约开发 部署智能合约"></a>eos智能合约开发 部署智能合约</h4><blockquote>
<p>这里部署智能合约我暂时只找到使用 命令行的方式部署，如果哪位同学知道其他的方式部署，请告诉我，谢谢</p>
</blockquote>
<blockquote>
<p>合约的部署又得创建钱包导入账户，和我们在scatter的方式一样，只不过这次是在命令行上操作了，那接下来继续走</p>
</blockquote>
<ul>
<li><p><img src="/images/contract4.png" alt="contract">   </p>
<pre><code>//显示当前的钱包，如果是按照教程来，应该如图显示
cleos wallet list 
</code></pre></li>
<li><p><img src="/images/contract5.png" alt="contract">  </p>
<pre><code>// 创建钱包，记住将返回的钱包密匙保存起来
cleos wallet create —-to-console 
// 显示钱包
cleos wallet list 
</code></pre></li>
<li><p><img src="/images/contract6.png" alt="contract">  </p>
<pre><code>// 导入我们之前的导入scatter的密匙对的私钥
// 执行后粘贴 私钥就好
cleos wallet import
</code></pre></li>
<li><p><img src="/images/contract6.png" alt="contract">  </p>
<pre><code>// 导入我们之前的导入scatter的密匙对的私钥
// 执行后粘贴 私钥就好
cleos wallet import
</code></pre></li>
<li><p><img src="/images/contract7.png" alt="contract">  </p>
<pre><code>// 部署合约 eee,注意看提示内容，RAM不够了，怎么办？去买
// 参数解释
// -u 指定部署合约的网络
// set contract  部署合约的命令
// shaokun11113  部署到哪个账户上，注意 这里这个账户的私钥必须被导入钱包且已在 -u指定网络上进行注册
// /Users/shaokun/Documents/todolist  abi 和 wasm的 绝对路径 ，建议不要使用相对路径
//-p 指定权限
cleos -u http://jungle.cryptolions.io:18888 set contract shaokun11113 /Users/shaokun/Documents/todolist -p shaokun11113@active
</code></pre></li>
<li><p><img src="/images/contract8.png" alt="contract">  </p>
<pre><code>// 购买RAM
// -u 去哪里买
// system buyram  购买ram的命令
// shaokun11113  谁去买，谁付钱
// shaokun11113  谁受益 买来的ram 给谁
// -k 买多少 kbytes 
cleos -u http://jungle.cryptolions.io:18888 system buyram shaokun11113 shaokun11113 -k 1024
</code></pre></li>
<li><p><img src="/images/contract9.png" alt="contract"><br>  有时候你也许会遇到这种情况 ，那就需要之前创建钱包时的密匙进行解锁钱包</p>
</li>
<li><p><img src="/images/contract10.png" alt="contract">  </p>
<pre><code>// 解锁默认钱包，输入钱包秘钥就好， 可以使用-n 指定解锁的钱包名字
cleos unlock wallet
</code></pre></li>
<li><p><img src="/images/contract11.png" alt="contract">  </p>
<pre><code>// 再次部署合约，可以看到结果eosio::setcode eosio::sebabi说明部署成功
cleos -u http://jungle.cryptolions.io:18888 set contract shaokun11113 /Users/shaokun/Documents/todolist -p shaokun11113@active
</code></pre></li>
</ul>
<h4 id="eos智能合约开发-使用scatter-js进行交互"><a href="#eos智能合约开发-使用scatter-js进行交互" class="headerlink" title="eos智能合约开发 使用scatter.js进行交互"></a>eos智能合约开发 使用scatter.js进行交互</h4><blockquote>
<p>这里使用 create-react-app 脚手架创建项目，删除无用的文件，启动项目。这里有疑问的请百度</p>
</blockquote>
<ul>
<li><img src="/images/contract12.png" alt="contract"> <img src="/images/contract13.png" alt="contract"> </li>
</ul>
<p>创建react项目,打开项目，删除无用的文件</p>
<ul>
<li><img src="/images/contract14.png" alt="contract"> </li>
</ul>
<p>启动项目，保证项目的正确性</p>
<ul>
<li><p><img src="/images/contract15.png" alt="contract"> </p>
<pre><code>// 安装scatter sdk
// 这里使用的是eosjs1,尝试了多种方式，未找到eosjs2的使用方式，如有知道的同学，还请告知
npm i -S scatterjs-core  scatterjs-plugin-eosjs
</code></pre></li>
<li><p><img src="/images/contract16.png" alt="contract"></p>
</li>
</ul>
<p>改造项目的布局</p>
<pre><code>render() {
    return (
        &lt;div&gt;

            &lt;div&gt;
                &lt;button onClick={() =&gt; this.createTodo()}&gt;create todo&lt;/button&gt;
                &lt;button onClick={() =&gt; this.deleteTodo()}&gt;delete todo&lt;/button&gt;
                &lt;input type=&quot;text&quot; onChange={e =&gt; {
                    this.setState({
                        deleteId: Number.parseInt(e.target.value)
                    })
                }}/&gt;

                &lt;button onClick={() =&gt; this.completeTodo()}&gt;complete todo&lt;/button&gt;
                &lt;input type=&quot;text&quot; onChange={e =&gt; {
                    this.setState({
                        competedId: Number.parseInt(e.target.value)
                    })
                }}/&gt;
                &lt;button onClick={() =&gt; this.showTodo()}&gt;show todo&lt;/button&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;p&gt;below is data&lt;/p&gt;
                &lt;ul&gt;
                    {
                        this.state.rows.map((todo, index) =&gt; {
                            return &lt;li key={index}&gt;
                                &lt;p&gt;id : {todo.id}&lt;/p&gt;
                                &lt;p&gt;description : {todo.description}&lt;/p&gt;
                                &lt;p&gt;completed : {todo.completed}&lt;/p&gt;
                            &lt;/li&gt;
                        })
                    }
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    );
}
</code></pre><ul>
<li><p>引入scatter sdk </p>
<pre><code>import React, {Component} from &apos;react&apos;;
import ScatterJS from &apos;scatterjs-core&apos;;
import ScatterEOS from &apos;scatterjs-plugin-eosjs&apos;;
import Eos from &apos;eosjs&apos;;

ScatterJS.plugins(new ScatterEOS());

const network = {
blockchain: &apos;eos&apos;,
protocol: &apos;http&apos;,
host: &apos;jungle.cryptolions.io&apos;,
port: 18888,
chainId:         &apos;038f4b0fc8ff18a4f0842a8f0564611f6e96e8535901dd45e43ac8691a1c4dca&apos;
}
</code></pre></li>
</ul>
<ul>
<li>初始化</li>
</ul>
<pre><code>componentDidMount() {
    setTimeout(() =&gt; {
        this.init()
    }, 2000)
}

init() {
ScatterJS.scatter.connect(&apos;eos&apos;).then(connected =&gt; {
    if (!connected) return false;
    const scatter = ScatterJS.scatter;

    this.setState({
        scatter
    });
    alert(&quot;scatter load success&quot;)
});
}    
</code></pre><ul>
<li><p><img src="/images/contract17.png" alt="contract">    </p>
<p>  增加 曾 删 改 查的功能</p>
<pre><code>createTodo() {
this.state.scatter.getIdentity(requiredFields).then(() =&gt; {
    const account = this.state.scatter.identity.accounts.find(x =&gt; x.blockchain === &apos;eos&apos;);
    const eos = this.state.scatter.eos(network, Eos);
    const transactionPermission = {authorization: [`${account.name}@${account.authority}`]};
    const num = Math.floor(Math.random() * 100000);
    eos.contract(account.name).then(ins =&gt; {
        ins.create(account.name, num, &quot;this is &quot; + num, transactionPermission).then(res =&gt; {
            console.log(res)
        })
    })

}).catch(error =&gt; {
    console.error(error);
});
}
</code></pre></li>
<li><p><img src="/images/eos11.gif" alt="contract">    </p>
</li>
</ul>
<p>启动项目，看看演示效果。可以看见与eos网络的交互还是很流畅，速度也很快。到此，基于eos网络开发dapp的流程应该算结束了，谢谢你的阅读。</p>
<h4 id="eos智能合约开发-总结"><a href="#eos智能合约开发-总结" class="headerlink" title="eos智能合约开发 总结"></a>eos智能合约开发 总结</h4><blockquote>
<p>本打算下周更新此篇文章，恰好今天原来的计划取消了，那就不拖了，下周有下周的事情呢<br>这里有几点需要大家注意：</p>
</blockquote>
<ul>
<li>一定要有梯子，不然根本无从谈起</li>
<li>eos要求硬件比较高，这个需要自己准备了</li>
<li>一定要先理解eos中的相关概念，和以太坊还是有很大的区别的</li>
<li>一定要先跟着官网的hello走一遍</li>
<li>如果哪一步遇到问题了，可以反复翻看这两篇文章，你一定能够成功的</li>
</ul>
<h4 id="eos智能合约开发-源码"><a href="#eos智能合约开发-源码" class="headerlink" title="eos智能合约开发 源码"></a>eos智能合约开发 源码</h4><p>2018-11-15 22:18:58更新<br>[源码送上…]<br>(<a href="https://shaokun11.github.io/2018/11/15/%E5%9F%BA%E4%BA%8Eeos%E8%BF%9E%E6%8E%A5scatter%E5%BC%80%E5%8F%91dapp(%E4%B8%8B)%20%E7%BB%AD" target="_blank" rel="noopener">https://shaokun11.github.io/2018/11/15/%E5%9F%BA%E4%BA%8Eeos%E8%BF%9E%E6%8E%A5scatter%E5%BC%80%E5%8F%91dapp(%E4%B8%8B)%20%E7%BB%AD</a>)</p>
<h4 id="接下来的计划"><a href="#接下来的计划" class="headerlink" title="接下来的计划"></a>接下来的计划</h4><ul>
<li>继续分享智能合约的知识，主要是基于eos,tron,eth三个平台，希望能够帮助到大家</li>
<li>分享一些编程语言知识，eth 和 tron 是用solidity写合约，eos是用c++写，前端展示页面是用react写的 </li>
</ul>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#115;&#107;&#x75;&#110;&#110;&#x79;&#x40;&#x31;&#54;&#51;&#46;&#x63;&#111;&#x6d;" target="_blank" rel="noopener">&#115;&#107;&#x75;&#110;&#110;&#x79;&#x40;&#x31;&#54;&#51;&#46;&#x63;&#111;&#x6d;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/13/基于eos连接scatter开发dapp(上)--补充 23.18.52/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/13/基于eos连接scatter开发dapp(上)--补充 23.18.52/" itemprop="url">结合scatter学习eos dapp开发，看这篇就够了（上）--补充</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-13T23:23:17+08:00">
                2018-10-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="eos智能合约开发-在jungle上创建account-续"><a href="#eos智能合约开发-在jungle上创建account-续" class="headerlink" title="eos智能合约开发 在jungle上创建account 续"></a>eos智能合约开发 在jungle上创建account 续</h4><blockquote>
<p>之前由于网络的原因，导致中断了，那我们继续接着来。自带梯子最重要</p>
</blockquote>
<p><img src="/images/jungle03.png" alt="jungle"><br>打开网站，输入之前的信息如图所示,点击左下角create<br><img src="/images/jungle4.png" alt="jungle"><br>创建成功后，会返回这样的信息，看见最下面有绿色的应该就是成功了吧<br>接下来我们查看一下我们创建的account的信息，回到主页，选择account info，输入刚才创建的account ，我这里输入shaokun11113 ,点击 get<br><img src="/images/jungle5.png" alt="jungle"><br><img src="/images/jungle6.png" alt="jungle"><br>可以看到返回了我们创建账号的信息:    </p>
<ul>
<li>balance  什么都没有   </li>
<li>activity key 和 owner key为我们刚才创建账户的时候输入的key  </li>
<li>RAM 目前账号的RAM情况，这里可以看到刚创建账号就已经消耗了一部分的RAM,为什么呢？ 因为你的账号信息要占用内存啊，所以说，创建账号得找到一个有eos的账号的用户帮你创建，他要为你支付这部分费用</li>
<li>net Bandwidth 存了100个eos,目前没有使用</li>
<li>cpu Bandwidth 存了100个eos，目前没有使用</li>
</ul>
<p>由于作为dapp开发者，那么我们得准备点eos,那么接下来我们再去获取一点eos吧<br>回到主页，选择 faucet，输入 你的账号，如图所示，通过验证，选择send coins 就好<br><img src="/images/jungle7.png" alt="jungle"><br>返回的结果如上所示，有兴趣的同学可以仔细看看这些内容。<br>那么我们如何知道我们是否收到了eos呢？<br>还是回到主页，进入 account info查询就好</p>
<p><img src="/images/jungle8.png" alt="jungle"> </p>
<p> 这里注意一下 balance 那一项就好，可以看到已经有100个eos和100个jungle token了</p>
<h4 id="eos智能合约开发-导入Account到scatter中"><a href="#eos智能合约开发-导入Account到scatter中" class="headerlink" title="eos智能合约开发 导入Account到scatter中"></a>eos智能合约开发 导入Account到scatter中</h4><blockquote>
<p>经过上一步骤，我们已经创建好了账户，接下来就讲账户导入到scatter中吧。在scatter中，这里叫做identity（身份）</p>
</blockquote>
<p><img src="/images/scatter17.png" alt="jungle"><br>进入scatter，选择身份。点击左下角的编辑的icon<br>如果你关闭过浏览器，请输入最开始的密码进入就好，如果忘记了，请输入助记词找回，如果丢了，就从头来一遍就好.<br><img src="/images/scatter18.png" alt="jungle"><br>这里我们注意一下 账户选项中的内容就好<br><img src="/images/scatter19.png" alt="jungle"><br>这里都是选择题，账户的第一项勾选我们创建网络时输入的名字，第二项勾选我们生成密匙对的名字就好，点击导入<br><img src="/images/scatter23.png" alt="jungle"><br>如果你看到了这个结果，不好意思，我也不知道你哪一步有问题。你可以从头开始再来一遍就好<br><img src="/images/scatter20.png" alt="jungle"><br>当然，我希望的是你看到的这个界面，通常我们选择active账号，然后点击右上角保存按钮<br><img src="/images/scatter21.png" alt="jungle"><br>回到这个界面，可以看到我们刚才创建的账户已经导入成功了，这里多一步的设置，把此账户设置为scatter的默认账户，这样以后调用scatter的时候就会默认选择此账户进行智能合约的调用了  勾选左下角的那个小圆圈的icon<br><img src="/images/scatter22.png" alt="jungle"><br>我们就可以看到我们账户的信息啦</p>
<p><strong>文章允许转载，但请注明出处，谢谢</strong></p>
<p><strong>这样一点点的敲下来，内容还是蛮多的。本打算一次写完，结果遇到网络的问题，暂停了一会，这篇文章算是对第一篇的补充吧。到目前为止，我们只是创建好了账户，还没有涉及到dapp的开发，接下来的具体怎么开发dapp估计要等到下周了吧。</strong></p>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。<br>email: <a href="mailto:&#x73;&#x6b;&#x75;&#x6e;&#x6e;&#x79;&#64;&#x31;&#54;&#51;&#x2e;&#x63;&#x6f;&#109;" target="_blank" rel="noopener">&#x73;&#x6b;&#x75;&#x6e;&#x6e;&#x79;&#64;&#x31;&#54;&#51;&#x2e;&#x63;&#x6f;&#109;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/13/基于eos连接scatter开发dapp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/13/基于eos连接scatter开发dapp/" itemprop="url">结合scatter 学习eos dapp开发, 看这篇就够了（上）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-13T15:14:24+08:00">
                2018-10-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="eos安装-方式1"><a href="#eos安装-方式1" class="headerlink" title="eos安装 方式1"></a>eos安装 方式1</h4><p><a href="https://developers.eos.io/eosio-home/docs/setting-up-your-environment" target="_blank" rel="noopener">eos安装1</a><br>这是eos官网推荐的安装方式。</p>
<p>官网推荐docker，可以减少不必要的麻烦 ，而且步骤超级详细，超级详细，要是安装不成功的话，请确认是否使用mac电脑或者官网推荐的其他操作系统，千万不要使用Windows系统来玩eos,因为官方说过不支持的哈。</p>
<h4 id="eos安装-方式2"><a href="#eos安装-方式2" class="headerlink" title="eos安装 方式2"></a>eos安装 方式2</h4><p><a href="https://developers.eos.io/eosio-nodeos/docs/getting-the-code" target="_blank" rel="noopener">eos 安装2</a> </p>
<pre><code>git clone https://github.com/EOSIO/eos --recursive
cd eos
./eosio_build.sh
./eosio_install.sh
// 从源码编译 准备好梯子很重要
</code></pre><h4 id="eoscdt安装"><a href="#eoscdt安装" class="headerlink" title="eoscdt安装"></a>eoscdt安装</h4><p><a href="https://developers.eos.io/eosio-home/docs/installing-the-contract-development-toolkit" target="_blank" rel="noopener">eosio.cdt 安装1</a> 这里遵循官网的步骤</p>
<pre><code>git clone --recursive https://github.com/eosio/eosio.cdt --branch     v1.2.1 --single-branch
cd eosio.cdt 
./build.sh eos
sudo ./install.sh
//这是新的生成wasm 和 abi的工具，以后官方会维护的，之前方式会在后续被移除 
</code></pre><p><a href="https://developers.eos.io/eosio-home/docs/installing-the-contract-development-toolkit" target="_blank" rel="noopener">eosio.cdt 安装2</a> 这里是最新的步骤</p>
<h4 id="eos安装-方式总结"><a href="#eos安装-方式总结" class="headerlink" title="eos安装 方式总结"></a>eos安装 方式总结</h4><p>简单，超级简单。<br>但是，受限于我们得环境，自备梯子是成功的第一步，第二步就是要一个适合的硬件，两者缺一不可。</p>
<h4 id="eos智能合约开发-开发体会"><a href="#eos智能合约开发-开发体会" class="headerlink" title="eos智能合约开发 开发体会"></a>eos智能合约开发 开发体会</h4><p>最好的学习资料就是官方提供的资料了，而且eos官方的资料具详细，在此送上<br><a href="https://developers.eos.io/" target="_blank" rel="noopener">eos官网</a></p>
<p>安装不是我要说的重点，过程艰辛就不说了，有问题Google或者度娘吧，我这里主要想要与大家分享的是如何使用scatter连接eos的测试网或者主网进行dapp的开发。  </p>
<p>上面的环境安装了可以启动本地的节点来进行测试，官网也是如此，而现在我能够搜索到的文章基本上也是基于本地节点使用命令行来进行开发，这样只能保证你学习开发eos的流程，但是具体怎样开发dapp你可能还是不清楚，因为你不知道如何连接scatter，如何与智能合约进行交互，所以这篇文章重点解决的问题是在这里。</p>
<p>这里再区分一下钱包开发和dapp的开发。钱包开发需要用户提供他的私钥给你，或者你创建好给用户。而我们此处所要使用的是官方的钱包scatter来进行开发dapp，不需要用户提供私钥给我们，他只需要接入官方提供的scatter就好，如果你有以太坊的经验，这就是metamask</p>
<h4 id="eos智能合约开发-scatter安装"><a href="#eos智能合约开发-scatter安装" class="headerlink" title="eos智能合约开发 scatter安装"></a>eos智能合约开发 scatter安装</h4><p>scatter，官方提供的eos钱包，这样用户才会放心把他们的密钥放进去，所以先安装它吧<br>scatter是chrome的插件，所以你先得安装它<a href="https://www.google.com/chrome/" target="_blank" rel="noopener">chrome浏览器下载</a><br>接下来把scatter 插件安装上 <a href="https://chrome.google.com/webstore/search/scatter?hl=zh-CN" target="_blank" rel="noopener">scatter Chrome插件</a>  </p>
<p><img src="/images/scatter00.png" alt="scatter"><br>搜索scatter安装就好，我这里是安装好的界面  </p>
<ul>
<li><img src="/images/scatter0.png" alt="scatter"><br>点击插件的scatter图标弹出如图界面，输入你的钱包密码然后点击生成钱包就好   </li>
<li><img src="/images/scatter1.png" alt="scatter"><br>助记词，抄写下来吧，以后恢复钱包用的   </li>
<li><img src="/images/scatter2.png" alt="scatter"><br>这里我选择skip basic setup，后续再来设置也是可行的  </li>
<li><img src="/images/scatter3.png" alt="scatter"><br>这个界面，点击右上角的⚙图标  </li>
<li><img src="/images/scatter4.png" alt="scatter"><br>这个界面，选择language，设置语言  </li>
<li><img src="/images/scatter5.png" alt="scatter"><br>设置好后，切换回来，成功了  <h4 id="eos智能合约开发-使用scatter生成密匙对"><a href="#eos智能合约开发-使用scatter生成密匙对" class="headerlink" title="eos智能合约开发 使用scatter生成密匙对"></a>eos智能合约开发 使用scatter生成密匙对</h4></li>
</ul>
<ol>
<li>经过以上的步骤，scatter已经安装好了，也就是我们创建了钱包，但是我们的钱包还没有内容的，为什么呢？这里我还是看看官网的这张图吧<br><img src="/images/eosio2.png" alt="eos钱包关系"></li>
<li>基于上张图的方式，我们得创建一对密匙，那就按照接下来的方式做吧<ul>
<li><img src="/images/scatter6.png" alt="scatter"><br>点击密匙对，点击新建</li>
<li><img src="/images/scatter7.png" alt="scatter"><br>点击生成密匙对  </li>
<li><img src="/images/scatter8.png" alt="scatter"><br>重点，记住这里的步骤不能省略<br>重点，记住这里的步骤不能省略<br>重点，记住这里的步骤不能省略<br>点击   复制  </li>
<li><img src="/images/scatter9.png" alt="scatter"><br>新开一个文本文档，点击粘贴，这样就把生成好的密匙对保存下来了，待会要用的  </li>
<li><img src="/images/scatter10.png" alt="scatter"><br>为这个密匙对取个名字，随便写，随意几好 </li>
<li><img src="/images/scatter11.png" alt="scatter"><br>完成了这些步骤，你应该能够看到上面的信息，如果没有，就再从头来一遍了。<br>这样我们的密匙对就创建好了，但是只是在本地创建好了的啊，怎么连接到测试网络和主网络呢？  </li>
</ul>
</li>
</ol>
<h4 id="eos智能合约开发-设置scatter连接-jungle-test-net"><a href="#eos智能合约开发-设置scatter连接-jungle-test-net" class="headerlink" title="eos智能合约开发 设置scatter连接 jungle test net"></a>eos智能合约开发 设置scatter连接 jungle test net</h4><ul>
<li><img src="/images/scatter5.png" alt="scatter net setting"><br>回到这个界面，选择设置图标，选择</li>
<li><img src="/images/scatter12.png" alt="scatter net setting"><br>这个界面选择网络  </li>
<li><img src="/images/scatter13.png" alt="scatter net setting"><br>这里可以看到已经有一个eos和eth的主网的网络节点，那么我们来把我们的测试网络的节点加入进去，点击右上角的新建  </li>
<li><img src="/images/scatter14.png" alt="scatter net setting"><br>这个界面就是设置网络所需要的一些必要信息，我们一个一个来填  <ol>
<li>由于我们是连接eos网络，所以这里第一项默认不变，下拉框可以选择eth,以后还可以支持tron</li>
<li>名称： 随便写一个，你自己记得住就好  </li>
<li>改成http,因为我们测试网络的endpoint就是用的这个协议，照改就好。</li>
<li>域名或ip地址：jungle.cryptolions.io    </li>
<li>端口 ：18888</li>
<li>chaninId:  038f4b0fc8ff18a4f0842a8f0564611f6e96e8535901dd45e43ac8691a1c4dca</li>
<li>如果你对以上填入的这些信息想知道为什么，那么可以补一下rpc协议，不想了解直接填入就好，以后就懂了  </li>
</ol>
</li>
<li><img src="/images/scatter15.png" alt="scatter net setting"><br>按照上述的步骤填完后，信息如上，点击右上角保存  </li>
<li><img src="/images/scatter16.png" alt="scatter net setting"><br>没有问题的话，会看到如上红框的显示内容，代表我们得测试网络已经设置好了</li>
</ul>
<h4 id="eos智能合约开发-在jungle测试网络上创建account"><a href="#eos智能合约开发-在jungle测试网络上创建account" class="headerlink" title="eos智能合约开发 在jungle测试网络上创建account"></a>eos智能合约开发 在jungle测试网络上创建account</h4><blockquote>
<p>为什么要创建账户呢？这就是eos的一大特点。BM说，你创建了一个密匙对，谁记得住呢，所以就设计了一个这样的账户系统，这个账户 长12位，只能由a-z12345这些字符组成。简而言之，方便记忆。</p>
</blockquote>
<ul>
<li><a href="http://jungle.cryptolions.io/#home" target="_blank" rel="noopener">jungle net account </a><br>打开jungle测试网络地址</li>
<li><img src="/images/jungle1.png" alt="jungle net account "><br>来到jungle的主页，点击 Create Account  </li>
<li><img src="/images/jungle2.png" alt="jungle net account ">  <ol>
<li>Account name : 看清楚要求 <em>小写字母 加上12345，总共12个字符</em><br>这里我写作 shaokun11113</li>
<li>owner public key : 将我们用scatter生成的那个密匙对的公钥填入这里</li>
<li>active public key: 将我们用scatter生成的那个密匙对的公钥填入这里</li>
<li>我这里用一对就好，在主网申请账号的时候建议使用两对密匙对。想要知道为什么？可以看看eos第二版的白皮书</li>
</ol>
</li>
<li><img src="/images/jungle03.png" alt="jungle net account "><br>这次我就这样填写，然后人机验证，通过后点击左下角的create,确保网络质量优良  </li>
</ul>
<h4 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h4><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<p>email: <a href="mailto:&#115;&#107;&#x75;&#x6e;&#110;&#121;&#x40;&#x31;&#x36;&#x33;&#46;&#x63;&#111;&#109;" target="_blank" rel="noopener">&#115;&#107;&#x75;&#x6e;&#110;&#121;&#x40;&#x31;&#x36;&#x33;&#46;&#x63;&#111;&#109;</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/02/关于bancor的理解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaokun">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hello shaokun">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/02/关于bancor的理解/" itemprop="url">带你以通俗易懂的小例子了解bancor</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-02T14:33:22+08:00">
                2018-10-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="bancor的简单概述"><a href="#bancor的简单概述" class="headerlink" title="bancor的简单概述"></a>bancor的简单概述</h5><blockquote>
<p>bancor是一种算法用于区块链的一种新的token的交易方式，目的是解决长尾的问题，增加ERC20的流通。长尾简单理解就是99%和1%的关系，即1%的token在大家的认知中有实际价值，而99%的token是没有的。那么通过bancor协议就是可以解决这99%的token，也可以给一个机会，让他们也有实际的价值。<br>具体可访问<a href="https://github.com/bancorprotocol/contracts" target="_blank" rel="noopener">bancor github repo</a>，这里有详细的介绍和白皮书</p>
</blockquote>
<h5 id="bancor名词展示"><a href="#bancor名词展示" class="headerlink" title="bancor名词展示"></a>bancor名词展示</h5><p><em>以下资料来自网络</em>  <strong>start</strong></p>
<p>Token的供应量【Smart Token’s Supply】，简称Supply；</p>
<p>Token的价格【Smart Token’s Price 】，简称Price；</p>
<p>Token的总市值【Smart Token’s Total Value】，简称TotalValue；</p>
<p>储备金余额【Connector Balance】，简称Balance；</p>
<p>储备金固定比率【Connector Weight】，简称CW。</p>
<p>计算公式如下：</p>
<pre><code>CW = Balance / TotalValue;

TotalValue = Price * Supply;

Price = Balance /（Supply * CW）
</code></pre><p>举例：若当前AToken的发行量为1000，报价为0.5个ETH兑换1个AToken，那么AToken的总价值为500个ETH，但是储备金余额可能并没有500个ETH，比如为250个ETH，那么CW则为0.5（50%)  </p>
<p>Token买入计算公式：</p>
<pre><code>Token_Return = Supply *（（1 + ETH_Amount / Balance）^ CW - 1）
//此公式的证明可以通过查看白皮书
</code></pre><blockquote>
<p>例如 若当前AToken的发行量为1000，储备金余额为250个ETH，CW为0.5，那么当前的报价则为0.5个ETH兑换1个AToken；现在Bob想花750个ETH购买AToken，带入公式：Token_Return = 1000 *（（1 + 750 / 250）^ 0.5 - 1）= 1000</p>
</blockquote>
<blockquote>
<p>即Bob花了750个ETH购买了1000个AToken，本次购买的平均价格为0.75个ETH兑换1个AToken。<br>Bob的购买行为推高了AToken的报价。若Bob接着购买同样数量的AToken，则需要付出更多的ETH代价，每一笔购买都会继续推高AToken的报价。</p>
</blockquote>
<p>Token卖出计算公式：</p>
<pre><code>ETH_Return = Balance *（1 - （1 - Token_Amount / Supply）^ （1 / CW））
</code></pre><blockquote>
<p>在Bob的那笔交易完成后，AToken的发行总量为2000个，储备金余额为1000个ETH，CW维持不变、仍然为0.5，那么通过公式可以计算当前的报价为1个ETH兑换1个AToken；现在Alice想卖掉1000个AToken，带入公式：ETH_Return = 1000 *（1 - （1 - 1000 / 2000）^ （1 /0.5））= 750</p>
</blockquote>
<blockquote>
<p>即Alice 卖掉了1000个AToken，获得了750个ETH，本次购买的平均价格为0.75个ETH兑换1个AToken。因为Bob的购买行为推高了AToken的报价，而Alice是在Bob的购买行为之后卖掉了AToken，所以Alice卖到了相对较高的价位。假如没有Bob的购买行为，回到AToken的供应量为1000的那个时候，Alice卖掉全部的AToken，也只能获得250个ETH  </p>
</blockquote>
<p>智能代币(Smart Tokens)</p>
<blockquote>
<p>智能代币是Bancor协议的核心。它们的运作类似于常规代币，在ETH区块链上使用的符合ERC20标准[5]，但也要包含额外的逻辑，即允许用户通过它的智能合约直接购买和出售代币，价格通过程序自动调整以反映供求关系。实际上，智能代币拥有一种内置的流动性机制，确保它们可以持续地为兑换为其他代币。  </p>
</blockquote>
<p>智能代币连接器(Smart Token connectors)  </p>
<blockquote>
<p>智能代币连接器可以被视为分布式、自主、透明和可预测的做市商，而不是交易所。智能代币通过程序自动调整它们的价格，来管理它们的连接器准备金，以保持它们与智能代币的总市值之间的比率是恒定的。<br>锚定代币(connected token)<br>每个智能代币都配置了连接器模块，这些模块持有它连接的另一个代币作为准备金（例如，BNT智能代币有一个连接到ETH的连接器，它持有ETH作为准备金）。ETH此时就是连接器代币。</p>
</blockquote>
<p>代币网络(token network)</p>
<blockquote>
<p>智能代币可以实现自己和它们的连接代币之间进行即时兑换。这个功能足以使智能代币即时兑换为一定数量的以类似的方式连接到同一网络的任何其他代币。通过这种方式，智能代币可以连接到无限数量的代币，从而创建一个分布式的流动性网络，该网络可能由数百万个代币组成，这些代币都可以以不断计算的价格自动地相互兑换。</p>
</blockquote>
<p>中继代币(Relay Token)  </p>
<blockquote>
<p>具有两个连接器的智能代币，其总CW恰好为100%，其功能类似于分布式代币兑换币对。中继代币允许用户在两个连接代币之间互相兑换，通过两步操作实现，即购买一种代币，立即出售另外一种代币。</p>
</blockquote>
<p>流动性代币(Liquid Tokens)</p>
<blockquote>
<p>具有组合连接器总权重低于100%（更典型的低于20%）的智能代币成为流动性代币。可能有一个或者多个连接器。例如，BTN具有单个权重为10%的ETH连接器。流动性代币可以使用连接器代币买卖（使用Bancor公式计算它相对于连接代币的价格），并且可以自适应调节供应量，在购买时增加，出售时减少。  </p>
</blockquote>
<p>代理代币(Proxy Token)</p>
<blockquote>
<p>具有一个连接器占100%权重的智能代币。</p>
</blockquote>
<p>组合代币(Array Token)</p>
<blockquote>
<p>具有三个或者更多连接器权重为100%的智能代币。</p>
</blockquote>
<p>糖果代币(Bounty Tokens)</p>
<blockquote>
<p>具有单个尚未激活连接器的智能代币（当前连接器准备金为0），可以向早起持有者（例如社区支持者）发放将来会发行的代币。</p>
</blockquote>
<p>网络代币(Network Tokens)</p>
<blockquote>
<p>由多个(&gt;2)智能代币持有作为连接代币的智能代币,BNT就是一个网络代币，也是一个流动性代币。</p>
</blockquote>
<p>交易者</p>
<blockquote>
<p>持有、兑换和支付智能代币的终端用户</p>
</blockquote>
<p>智能代币发行者</p>
<blockquote>
<p>发行智能代币，配置初始供应量、价格、连接器权重CW和管理智能代币初始发行的人员、公司、社区、组织或基金会。还包括将现有ERC20代币连接到Bancor网络的中继代币的创建者。</p>
</blockquote>
<p>资产代币化者</p>
<blockquote>
<p>将代理代币或者组合代币映射到实体资产或者其他区块链上代币的创建者。这允许智能代币连接到更广泛的资产，如比特币、法定货币、黄金或其他新兴的区块链代币。</p>
</blockquote>
<p>套利者</p>
<blockquote>
<p>监控Bancor流动性网络与外部交易所或者其他智能代币的价格，并且通过套利消除价差的交易者。套利者通过消除价差获得奖励，因此是Bancor生态系统的重要参与者。 </p>
</blockquote>
<p><strong><em>end</em></strong></p>
<h5 id="我之理解"><a href="#我之理解" class="headerlink" title="我之理解"></a>我之理解</h5><pre><code>cw的理解可以参考很那张很经典的图
cw&lt;50%:price与supply的变化可理解为指数函数y = x^N 的形式变化
cw=50%:price与supply的变化可理解为一次函数y = ax (a&gt;0)的形式变化
cw&gt;50%:price与supply的变化可理解为对数函数y = y=logN(x)的形式变化
cw=100%:price与supply的变化可理解为常数函数y = x的形式变化  
</code></pre><ol>
<li>我发行一个smart token（暂且叫sk）,总量1000个 ，即supply= 1000 sk</li>
<li>预估一下我这个项目的价值，暂且估计价值1000个eth ，即TotalValue = 1000 eth</li>
<li>而我只有100个eth,那作为储备金，剩余的向大家融资吧,即balance = 100 eth</li>
<li>设定cw = 10%，</li>
<li>根据算法，得到price = 1 sk/eth，</li>
<li>到此，可理解为我用100eth以单价为10买了1000 sk,</li>
<li>使用100 eth买入，根据买入公式，得到(（1+（100/100））^0.1 - 1) <em> 1000= 0.0718 </em>  1000 = 71.8个sk，</li>
<li>当执行上笔交易后，cw是不会变得，其余的会动态调整。那么此时的sk supply = 1071.8 sk,balance = 200 eth，price = 1.866 sk / eth</li>
<li>这里可以看到买入100个后，一个sk价值1.866个eth,价格上涨了呢。这里有兴趣的同学可以试试连续分批次买10次，每次10个eth，可以看到价格的变化,最终的结果也是一样的，这就是bancor算法保证的结果</li>
<li>再继续使用100eth买入，根据买入公式，得到(（1+（100/200））^0.1 - 1) <em> 1071.8= 0.0414 </em>  1071.8 = 44.37个sk，这样后来买的价格就比之前的高了，获得的sk就会少，也就是价格高了</li>
<li>supply = 1116.7 sk,balance = 300 eth，price = 26.86 sk/eth 单价已经翻了20倍了</li>
<li>卖出50 sk，根据卖出公式 300 *（1 - 50/1116.7）^(1/0.1) = 189.7488 eth   </li>
<li>额，初始值设定的不恰当，整个流程算出来的结果有点恐怖，有兴趣的同学可以按照流程调整一下初始值哈0.0</li>
<li>这里可能有同学会问了，我刚使用100eth获得44个sk,我马上又卖出50个sk可以得到189个eth，大赚了啊。理论上是成立的，但是你得保证你这两个操作中间没有其他人的卖出哈（买入你就赚得越多），其他人卖出之后，你再去卖价格就低了，所以得自己评估风险哦  </li>
</ol>
<p>小结：</p>
<ul>
<li>控制cw的变化，可以控制token的价格的走势</li>
<li>买入,会提高smart token的价格，卖出会降低smart token的价格，具体变化由cw的决定</li>
<li>缺点：这些数据都是采用智能合约编写的，无法改变。但是项目方可以更改cw的值，从而控制整个token的价格走势</li>
<li>优点：你如果持有smart token是可以随时和储备金类型的token进行买卖的。这都是由智能合约自动执行，这点可以相对于传统的1co有着更好的安全，至少你持有的token有着更好的流通性，随时都可以流通，也可以换取其他的token或者储备金的token  </li>
</ul>
<h5 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h5><p>区块链技术痴迷的程序猿一枚，如果你喜欢我的文章，可以加上微信共同学习，共同进步。  </p>
<h5 id="资料更新-2018-10-13-15-50-20"><a href="#资料更新-2018-10-13-15-50-20" class="headerlink" title="资料更新 2018-10-13 15:50:20"></a>资料更新 2018-10-13 15:50:20</h5><p>更新一下，这里补上bancor的经典cw图，便于大家理解。<br><img src="/bancor/bancor.png" alt="cw"><br>根据这张图中的曲线，那么你所持有的币的价值就是等于曲线上任意两点作x轴 所形成的面积。所以任何一点点的买入卖出都会影响整个智能代币的价格<br>另外附上bancor的白皮书<br><a href="https://storage.googleapis.com/website-bancor/2018/04/01ba8253-bancor_protocol_whitepaper_en.pdf" target="_blank" rel="noopener">bancor 白皮书 英文版</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">shaokun</p>
              <p class="site-description motion-element" itemprop="description">记录自己对相关技术的点点滴滴和一些思考，希望能够帮助来到这里的你，如果你喜欢我的文章，可以加个微信共同探讨</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shaokun</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        
<div class="busuanzi-count">
 <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 访问总量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
